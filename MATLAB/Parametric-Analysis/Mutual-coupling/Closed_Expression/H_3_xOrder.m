function [ H3_total ] = H_3_xOrder( L2, L1, d, frequency, order )
%k^2*exp(-k*((x - x_prime)^2 + (y - y_prime)^2)^(1/2)*1i)*(2*x - 2*x_prime)^2)/(16*pi*((x - x_prime)^2 + (y - y_prime)^2)^(3/2))

lambda = 3E8/frequency;
k = 2*pi/lambda;

if order == 2
    H_3_2Order=(-1/2880).*k.^5.*pi.^(-1).*((-1440).*(d.^2).^(1/2).*k.^(-3)+(-240) ...
        .*(d.^2).^(3/2).*k.^(-1)+15.*d.^4.*(d.^2).^(1/2).*k+(-5).*(d.^2) ...
        .^(5/2).*k+(sqrt(-1)*(-10)).*L1.^4+1440.*k.^(-3).*(d.^2+L1.^2).^( ...
        1/2)+180.*d.^2.*k.^(-1).*(d.^2+L1.^2).^(1/2)+(-15).*d.^4.*k.*( ...
        d.^2+L1.^2).^(1/2)+60.*k.^(-1).*(d.^2+L1.^2).^(3/2)+5.*d.^2.*k.*( ...
        d.^2+L1.^2).^(3/2)+(sqrt(-1)*(-360)).*d.^2.*k.^(-2).*log(d.^2)+( ...
        sqrt(-1)*720).*d.^2.*k.^(-2).*((-1).*d.^(-1).*L1.*atan(d.^(-1).* ...
        L1)+(1/2).*log(d.^2+L1.^2))+(-720).*k.^(-3).*L1.*log(L1+(d.^2+ ...
        L1.^2).^(1/2))+(-180).*d.^2.*k.^(-1).*L1.*log(L1+(d.^2+L1.^2).^( ...
        1/2))+15.*d.^4.*k.*L1.*log(L1+(d.^2+L1.^2).^(1/2)))+(1/2880).* ...
        k.^5.*pi.^(-1).*(720.*k.^(-3).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+ ...
        180.*d.^2.*k.^(-1).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-15).*d.^4.* ...
        k.*(d.^2+(L1+(-1).*L2).^2).^(1/2)+(sqrt(-1)*(-10)).*(L1+(-1).*L2) ...
        .^4+(sqrt(-1)*(-720)).*k.^(-2).*L1.*L2+(sqrt(-1)*6).*d.^4.*k.^2.* ...
        L1.*L2+(sqrt(-1)*2).*d.^2.*k.^2.*L1.^3.*L2+(sqrt(-1)*(-3)).*d.^2.* ...
        k.^2.*L1.^2.*L2.^2+(sqrt(-1)*2).*d.^2.*k.^2.*L1.*L2.^3+(sqrt(-1)* ...
        10).*L2.^4+(-1440).*k.^(-3).*(d.^2+L2.^2).^(1/2)+(-180).*d.^2.* ...
        k.^(-1).*(d.^2+L2.^2).^(1/2)+15.*d.^4.*k.*(d.^2+L2.^2).^(1/2)+( ...
        -60).*k.^(-1).*(d.^2+L2.^2).^(3/2)+(-5).*d.^2.*k.*(d.^2+L2.^2).^( ...
        3/2)+720.*k.^(-3).*(d.^2+(L1+(-1).*L2).^2).^(-1/2).*(d.^2+L1.^2+( ...
        -2).*L1.*L2+L2.^2)+60.*k.^(-1).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*( ...
        d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+5.*d.^2.*k.*(d.^2+(L1+(-1).*L2).^2) ...
        .^(1/2).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+(sqrt(-1)*720).*d.*k.^( ...
        -2).*L2.*atan(d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*720).*d.*k.^(-2).* ...
        L2.*atan(d.^(-1).*L2)+(sqrt(-1)*720).*d.^2.*k.^(-2).*((-1).*d.^( ...
        -1).*L1.*atan(d.^(-1).*(L1+(-1).*L2))+(1/2).*log(d.^2+(L1+(-1).* ...
        L2).^2))+(-720).*k.^(-3).*(L1+(-1).*L2).*log(L1+(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2)+(-1).*L2)+(-180).*d.^2.*k.^(-1).*(L1+(-1).*L2).* ...
        log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+15.*d.^4.*k.*(L1+( ...
        -1).*L2).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+(sqrt( ...
        -1)*(-360)).*d.^2.*k.^(-2).*log(d.^2+L2.^2)+(-720).*k.^(-3).*L2.* ...
        log((-1).*L2+(d.^2+L2.^2).^(1/2))+(-180).*d.^2.*k.^(-1).*L2.*log(( ...
        -1).*L2+(d.^2+L2.^2).^(1/2))+15.*d.^4.*k.*L2.*log((-1).*L2+(d.^2+ ...
        L2.^2).^(1/2)));
    H3_total = H_3_2Order;
    
elseif order == 3
    H_3_3Order = (-1/23040).*k.^5.*pi.^(-1).*((-5760).*(d.^2).^(1/2).*k.^(-3)+( ...
        -2880).*(d.^2).^(1/2).*k.^(-3).*(2+d.^2.*k.^2)+80.*(d.^2).^(3/2).* ...
        k.^(-1).*(12+d.^2.*k.^2)+(-3).*d.^4.*(d.^2).^(1/2).*k.*(30+d.^2.* ...
        k.^2)+(7/5).*(d.^2).^(5/2).*k.*(30+d.^2.*k.^2)+5760.*k.^(-3).*( ...
        d.^2+L1.^2).^(1/2)+2880.*k.^(-3).*(2+d.^2.*k.^2).*(d.^2+L1.^2).^( ...
        1/2)+(-120).*d.^2.*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+ ...
        3.*d.^4.*k.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+40.*k.^(-1).*(12+ ...
        d.^2.*k.^2).*(d.^2+L1.^2).^(3/2)+(-1).*d.^2.*k.*(30+d.^2.*k.^2).*( ...
        d.^2+L1.^2).^(3/2)+(-2/5).*k.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(5/2) ...
        +(sqrt(-1)*(-2880)).*d.^2.*k.^(-2).*log(d.^2)+(sqrt(-1)*5760).* ...
        d.^2.*k.^(-2).*((-1).*d.^(-1).*L1.*atan(d.^(-1).*L1)+(1/2).*log( ...
        d.^2+L1.^2))+(-2880).*k.^(-3).*(2+d.^2.*k.^2).*L1.*log(L1+(d.^2+ ...
        L1.^2).^(1/2))+120.*d.^2.*k.^(-1).*(12+d.^2.*k.^2).*L1.*log(L1+( ...
        d.^2+L1.^2).^(1/2))+(-3).*d.^4.*k.*(30+d.^2.*k.^2).*L1.*log(L1+( ...
        d.^2+L1.^2).^(1/2)))+(1/23040).*k.^5.*pi.^(-1).*(2880.*k.^(-3).*( ...
        2+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-120).*d.^2.*k.^( ...
        -1).*(12+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+3.*d.^4.*k.*( ...
        30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+(sqrt(-1)*(-960)).* ...
        d.^2.*L1.*L2+(sqrt(-1)*(-5760)).*k.^(-2).*L1.*L2+(sqrt(-1)*48).* ...
        d.^2.*(20+d.^2.*k.^2).*L1.*L2+(sqrt(-1)*16).*(20+d.^2.*k.^2).* ...
        L1.^3.*L2+(sqrt(-1)*(-24)).*(20+d.^2.*k.^2).*L1.^2.*L2.^2+(sqrt( ...
        -1)*16).*(20+d.^2.*k.^2).*L1.*L2.^3+(-5760).*k.^(-3).*(d.^2+L2.^2) ...
        .^(1/2)+(-2880).*k.^(-3).*(2+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2)+ ...
        120.*d.^2.*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2)+(-3).* ...
        d.^4.*k.*(30+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2)+(-40).*k.^(-1).*(12+ ...
        d.^2.*k.^2).*(d.^2+L2.^2).^(3/2)+d.^2.*k.*(30+d.^2.*k.^2).*(d.^2+ ...
        L2.^2).^(3/2)+(2/5).*k.*(30+d.^2.*k.^2).*(d.^2+L2.^2).^(5/2)+(-1) ...
        .*d.^2.*k.*(30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^2.*(d.^2+ ...
        L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2)+(-2/5).*k.*(30+d.^2.*k.^2).*( ...
        d.^2+(L1+(-1).*L2).^2).^3.*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2) ...
        +5760.*k.^(-3).*(d.^2+(L1+(-1).*L2).^2).^(-1/2).*(d.^2+L1.^2+(-2) ...
        .*L1.*L2+L2.^2)+40.*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2) ...
        .^2).^(1/2).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+(sqrt(-1)*5760).*d.* ...
        k.^(-2).*L2.*atan(d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*5760).*d.*k.^( ...
        -2).*L2.*atan(d.^(-1).*L2)+(sqrt(-1)*5760).*d.^2.*k.^(-2).*((-1).* ...
        d.^(-1).*L1.*atan(d.^(-1).*(L1+(-1).*L2))+(1/2).*log(d.^2+(L1+(-1) ...
        .*L2).^2))+(-2880).*k.^(-3).*(2+d.^2.*k.^2).*(L1+(-1).*L2).*log( ...
        L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+120.*d.^2.*k.^(-1).*( ...
        12+d.^2.*k.^2).*(L1+(-1).*L2).*log(L1+(d.^2+(L1+(-1).*L2).^2).^( ...
        1/2)+(-1).*L2)+(-3).*d.^4.*k.*(30+d.^2.*k.^2).*(L1+(-1).*L2).*log( ...
        L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+(sqrt(-1)*(-2880)).* ...
        d.^2.*k.^(-2).*log(d.^2+L2.^2)+(-2880).*k.^(-3).*(2+d.^2.*k.^2).* ...
        L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2))+120.*d.^2.*k.^(-1).*(12+ ...
        d.^2.*k.^2).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2))+(-3).*d.^4.*k.* ...
        (30+d.^2.*k.^2).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2)));
    H3_total = H_3_3Order;
elseif order == 4
    H3_4O=(-1/2419200).*k.^2.*pi.^(-1).*((-604800).*(d.^2).^(1/2)+(-302400) ...
        .*(d.^2).^(1/2).*(2+d.^2.*k.^2)+8400.*(d.^2).^(3/2).*k.^2.*(12+ ...
        d.^2.*k.^2)+(-315).*d.^4.*(d.^2).^(1/2).*k.^4.*(30+d.^2.*k.^2)+ ...
        147.*(d.^2).^(5/2).*k.^4.*(30+d.^2.*k.^2)+604800.*(d.^2+L1.^2).^( ...
        1/2)+302400.*(2+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+(-12600).*d.^2.* ...
        k.^2.*(12+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+315.*d.^4.*k.^4.*(30+ ...
        d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+4200.*k.^2.*(12+d.^2.*k.^2).*( ...
        d.^2+L1.^2).^(3/2)+(-105).*d.^2.*k.^4.*(30+d.^2.*k.^2).*(d.^2+ ...
        L1.^2).^(3/2)+(-42).*k.^4.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(5/2)+( ...
        sqrt(-1)*(-302400)).*d.^2.*k.*log(d.^2)+(sqrt(-1)*604800).*d.^2.* ...
        k.*((-1).*d.^(-1).*L1.*atan(d.^(-1).*L1)+(1/2).*log(d.^2+L1.^2))+( ...
        -302400).*(2+d.^2.*k.^2).*L1.*log(L1+(d.^2+L1.^2).^(1/2))+12600.* ...
        d.^2.*k.^2.*(12+d.^2.*k.^2).*L1.*log(L1+(d.^2+L1.^2).^(1/2))+( ...
        -315).*d.^4.*k.^4.*(30+d.^2.*k.^2).*L1.*log(L1+(d.^2+L1.^2).^(1/2) ...
        ))+(1/2419200).*k.^2.*pi.^(-1).*(302400.*(2+d.^2.*k.^2).*(d.^2+( ...
        L1+(-1).*L2).^2).^(1/2)+(-12600).*d.^2.*k.^2.*(12+d.^2.*k.^2).*( ...
        d.^2+(L1+(-1).*L2).^2).^(1/2)+315.*d.^4.*k.^4.*(30+d.^2.*k.^2).*( ...
        d.^2+(L1+(-1).*L2).^2).^(1/2)+(sqrt(-1)*(-100800)).*k.*(6+d.^2.* ...
        k.^2).*L1.*L2+(sqrt(-1)*5040).*d.^2.*k.^3.*(20+d.^2.*k.^2).*L1.* ...
        L2+(sqrt(-1)*(-120)).*d.^4.*k.^5.*(42+d.^2.*k.^2).*L1.*L2+(sqrt( ...
        -1)*1680).*k.^3.*(20+d.^2.*k.^2).*L1.^3.*L2+(sqrt(-1)*(-80)).* ...
        d.^2.*k.^5.*(42+d.^2.*k.^2).*L1.^3.*L2+(sqrt(-1)*(-24)).*k.^5.*( ...
        42+d.^2.*k.^2).*L1.^5.*L2+(sqrt(-1)*(-2520)).*k.^3.*(20+d.^2.* ...
        k.^2).*L1.^2.*L2.^2+(sqrt(-1)*120).*d.^2.*k.^5.*(42+d.^2.*k.^2).* ...
        L1.^2.*L2.^2+(sqrt(-1)*60).*k.^5.*(42+d.^2.*k.^2).*L1.^4.*L2.^2+( ...
        sqrt(-1)*1680).*k.^3.*(20+d.^2.*k.^2).*L1.*L2.^3+(sqrt(-1)*(-80)) ...
        .*d.^2.*k.^5.*(42+d.^2.*k.^2).*L1.*L2.^3+(sqrt(-1)*(-80)).*k.^5.*( ...
        42+d.^2.*k.^2).*L1.^3.*L2.^3+(sqrt(-1)*60).*k.^5.*(42+d.^2.*k.^2) ...
        .*L1.^2.*L2.^4+(sqrt(-1)*(-24)).*k.^5.*(42+d.^2.*k.^2).*L1.*L2.^5+ ...
        (-604800).*(d.^2+L2.^2).^(1/2)+(-302400).*(2+d.^2.*k.^2).*(d.^2+ ...
        L2.^2).^(1/2)+12600.*d.^2.*k.^2.*(12+d.^2.*k.^2).*(d.^2+L2.^2).^( ...
        1/2)+(-315).*d.^4.*k.^4.*(30+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2)+( ...
        -4200).*k.^2.*(12+d.^2.*k.^2).*(d.^2+L2.^2).^(3/2)+105.*d.^2.* ...
        k.^4.*(30+d.^2.*k.^2).*(d.^2+L2.^2).^(3/2)+42.*k.^4.*(30+d.^2.* ...
        k.^2).*(d.^2+L2.^2).^(5/2)+(-105).*d.^2.*k.^4.*(30+d.^2.*k.^2).*( ...
        d.^2+(L1+(-1).*L2).^2).^2.*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2) ...
        +(-42).*k.^4.*(30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^3.*(d.^2+ ...
        L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2)+604800.*(d.^2+(L1+(-1).*L2).^2) ...
        .^(-1/2).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+4200.*k.^2.*(12+d.^2.* ...
        k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*(d.^2+L1.^2+(-2).*L1.*L2+ ...
        L2.^2)+(sqrt(-1)*604800).*d.*k.*L2.*atan(d.^(-1).*(L1+(-1).*L2))+( ...
        sqrt(-1)*604800).*d.*k.*L2.*atan(d.^(-1).*L2)+(sqrt(-1)*604800).* ...
        d.^2.*k.*((-1).*d.^(-1).*L1.*atan(d.^(-1).*(L1+(-1).*L2))+(1/2).* ...
        log(d.^2+(L1+(-1).*L2).^2))+(-302400).*(2+d.^2.*k.^2).*(L1+(-1).* ...
        L2).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+12600.*d.^2.* ...
        k.^2.*(12+d.^2.*k.^2).*(L1+(-1).*L2).*log(L1+(d.^2+(L1+(-1).*L2) ...
        .^2).^(1/2)+(-1).*L2)+(-315).*d.^4.*k.^4.*(30+d.^2.*k.^2).*(L1+( ...
        -1).*L2).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+(sqrt( ...
        -1)*(-302400)).*d.^2.*k.*log(d.^2+L2.^2)+(-302400).*(2+d.^2.*k.^2) ...
        .*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2))+12600.*d.^2.*k.^2.*(12+ ...
        d.^2.*k.^2).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2))+(-315).*d.^4.* ...
        k.^4.*(30+d.^2.*k.^2).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2)));
    H3_total = H3_4O;
    
elseif order ==5
    H_3_5Order=(-1/38707200).*k.^5.*pi.^(-1).*((-9676800).*(d.^2).^(1/2).*k.^(-3) ...
        +(-4838400).*(d.^2).^(1/2).*k.^(-3).*(2+d.^2.*k.^2)+134400.*(d.^2) ...
        .^(3/2).*k.^(-1).*(12+d.^2.*k.^2)+(-5040).*d.^4.*(d.^2).^(1/2).* ...
        k.*(30+d.^2.*k.^2)+2352.*(d.^2).^(5/2).*k.*(30+d.^2.*k.^2)+(240/7) ...
        .*d.^6.*(d.^2).^(1/2).*k.^3.*(56+d.^2.*k.^2)+9676800.*k.^(-3).*( ...
        d.^2+L1.^2).^(1/2)+4838400.*k.^(-3).*(2+d.^2.*k.^2).*(d.^2+L1.^2) ...
        .^(1/2)+(-201600).*d.^2.*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+L1.^2).^( ...
        1/2)+5040.*d.^4.*k.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+(-75).* ...
        d.^6.*k.^3.*(56+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2)+67200.*k.^(-1).*( ...
        12+d.^2.*k.^2).*(d.^2+L1.^2).^(3/2)+(-1680).*d.^2.*k.*(30+d.^2.* ...
        k.^2).*(d.^2+L1.^2).^(3/2)+(-672).*k.*(30+d.^2.*k.^2).*(d.^2+ ...
        L1.^2).^(5/2)+(5/2).*k.^3.*(56+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).*( ...
        (114/7).*d.^6+(174/7).*d.^4.*L1.^2+(76/7).*d.^2.*L1.^4+(16/7).* ...
        L1.^6)+(sqrt(-1)*(-4838400)).*d.^2.*k.^(-2).*log(d.^2)+(sqrt(-1)* ...
        9676800).*d.^2.*k.^(-2).*((-1).*d.^(-1).*L1.*atan(d.^(-1).*L1)+( ...
        1/2).*log(d.^2+L1.^2))+(-4838400).*k.^(-3).*(2+d.^2.*k.^2).*L1.* ...
        log(L1+(d.^2+L1.^2).^(1/2))+201600.*d.^2.*k.^(-1).*(12+d.^2.*k.^2) ...
        .*L1.*log(L1+(d.^2+L1.^2).^(1/2))+(-5040).*d.^4.*k.*(30+d.^2.* ...
        k.^2).*L1.*log(L1+(d.^2+L1.^2).^(1/2))+75.*d.^6.*k.^3.*(56+d.^2.* ...
        k.^2).*L1.*log(L1+(d.^2+L1.^2).^(1/2)))+(1/38707200).*k.^5.*pi.^( ...
        -1).*(4838400.*k.^(-3).*(2+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^( ...
        1/2)+(-201600).*d.^2.*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2)+5040.*d.^4.*k.*(30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2) ...
        .^2).^(1/2)+(-75).*d.^6.*k.^3.*(56+d.^2.*k.^2).*(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2)+(sqrt(-1)*(-1612800)).*d.^2.*L1.*L2+(sqrt(-1)*( ...
        -9676800)).*k.^(-2).*L1.*L2+(sqrt(-1)*80640).*d.^2.*(20+d.^2.* ...
        k.^2).*L1.*L2+(sqrt(-1)*(-1920)).*d.^4.*k.^2.*(42+d.^2.*k.^2).* ...
        L1.*L2+(sqrt(-1)*26880).*(20+d.^2.*k.^2).*L1.^3.*L2+(sqrt(-1)*( ...
        -1280)).*d.^2.*k.^2.*(42+d.^2.*k.^2).*L1.^3.*L2+(sqrt(-1)*(-384)) ...
        .*k.^2.*(42+d.^2.*k.^2).*L1.^5.*L2+(sqrt(-1)*(-40320)).*(20+d.^2.* ...
        k.^2).*L1.^2.*L2.^2+(sqrt(-1)*1920).*d.^2.*k.^2.*(42+d.^2.*k.^2).* ...
        L1.^2.*L2.^2+(sqrt(-1)*960).*k.^2.*(42+d.^2.*k.^2).*L1.^4.*L2.^2+( ...
        sqrt(-1)*26880).*(20+d.^2.*k.^2).*L1.*L2.^3+(sqrt(-1)*(-1280)).* ...
        d.^2.*k.^2.*(42+d.^2.*k.^2).*L1.*L2.^3+(sqrt(-1)*(-1280)).*k.^2.*( ...
        42+d.^2.*k.^2).*L1.^3.*L2.^3+(sqrt(-1)*960).*k.^2.*(42+d.^2.*k.^2) ...
        .*L1.^2.*L2.^4+(sqrt(-1)*(-384)).*k.^2.*(42+d.^2.*k.^2).*L1.* ...
        L2.^5+(-9676800).*k.^(-3).*(d.^2+L2.^2).^(1/2)+(-4838400).*k.^(-3) ...
        .*(2+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2)+201600.*d.^2.*k.^(-1).*(12+ ...
        d.^2.*k.^2).*(d.^2+L2.^2).^(1/2)+(-5040).*d.^4.*k.*(30+d.^2.*k.^2) ...
        .*(d.^2+L2.^2).^(1/2)+75.*d.^6.*k.^3.*(56+d.^2.*k.^2).*(d.^2+ ...
        L2.^2).^(1/2)+(-67200).*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+L2.^2).^( ...
        3/2)+1680.*d.^2.*k.*(30+d.^2.*k.^2).*(d.^2+L2.^2).^(3/2)+672.*k.*( ...
        30+d.^2.*k.^2).*(d.^2+L2.^2).^(5/2)+(-1680).*d.^2.*k.*(30+d.^2.* ...
        k.^2).*(d.^2+(L1+(-1).*L2).^2).^2.*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2) ...
        .^(-1/2)+(-672).*k.*(30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^3.*( ...
        d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2)+(5/2).*k.^3.*(56+d.^2.* ...
        k.^2).*(d.^2+(L1+(-1).*L2).^2).*((114/7).*d.^6+(174/7).*d.^4.*(L1+ ...
        (-1).*L2).^2+(76/7).*d.^2.*(L1+(-1).*L2).^4+(16/7).*(L1+(-1).*L2) ...
        .^6).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2)+9676800.*k.^(-3).*( ...
        d.^2+(L1+(-1).*L2).^2).^(-1/2).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+ ...
        67200.*k.^(-1).*(12+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*( ...
        d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+(-5/2).*k.^3.*(56+d.^2.*k.^2).*( ...
        d.^2+L2.^2).^(1/2).*((114/7).*d.^6+(174/7).*d.^4.*L2.^2+(76/7).* ...
        d.^2.*L2.^4+(16/7).*L2.^6)+(sqrt(-1)*9676800).*d.*k.^(-2).*L2.* ...
        atan(d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*9676800).*d.*k.^(-2).*L2.* ...
        atan(d.^(-1).*L2)+(sqrt(-1)*9676800).*d.^2.*k.^(-2).*((-1).*d.^( ...
        -1).*L1.*atan(d.^(-1).*(L1+(-1).*L2))+(1/2).*log(d.^2+(L1+(-1).* ...
        L2).^2))+(-4838400).*k.^(-3).*(2+d.^2.*k.^2).*(L1+(-1).*L2).*log( ...
        L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+201600.*d.^2.*k.^(-1) ...
        .*(12+d.^2.*k.^2).*(L1+(-1).*L2).*log(L1+(d.^2+(L1+(-1).*L2).^2) ...
        .^(1/2)+(-1).*L2)+(-5040).*d.^4.*k.*(30+d.^2.*k.^2).*(L1+(-1).*L2) ...
        .*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+75.*d.^6.*k.^3.* ...
        (56+d.^2.*k.^2).*(L1+(-1).*L2).*log(L1+(d.^2+(L1+(-1).*L2).^2).^( ...
        1/2)+(-1).*L2)+(sqrt(-1)*(-4838400)).*d.^2.*k.^(-2).*log(d.^2+ ...
        L2.^2)+(-4838400).*k.^(-3).*(2+d.^2.*k.^2).*L2.*log((-1).*L2+( ...
        d.^2+L2.^2).^(1/2))+201600.*d.^2.*k.^(-1).*(12+d.^2.*k.^2).*L2.* ...
        log((-1).*L2+(d.^2+L2.^2).^(1/2))+(-5040).*d.^4.*k.*(30+d.^2.* ...
        k.^2).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2))+75.*d.^6.*k.^3.*(56+ ...
        d.^2.*k.^2).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2)));
    H3_total = H_3_5Order;
elseif order == 6
    
    H3_total=(-1/812851200).*k.^2.*pi.^(-1).*((-3).*(d.^2).^(1/2).*(135475200+ ...
        22579200.*d.^2.*k.^2+(-376320).*d.^4.*k.^4+5376.*d.^6.*k.^6+(-240) ...
        .*d.^8.*k.^8)+3.*(d.^2+L1.^2).^(1/2).*((-240).*d.^8.*k.^8+d.^6.*( ...
        5376.*k.^6+435.*k.^8.*L1.^2)+2.*d.^4.*k.^4.*((-188160)+1596.* ...
        k.^2.*L1.^2+95.*k.^4.*L1.^4)+2240.*(60480+2520.*k.^2.*L1.^2+(-63) ...
        .*k.^4.*L1.^4+k.^6.*L1.^6)+8.*d.^2.*k.^2.*(2822400+(-20580).* ...
        k.^2.*L1.^2+742.*k.^4.*L1.^4+5.*k.^6.*L1.^6))+(-101606400).*d.*k.* ...
        (d+(sqrt(-1)*(-1)).*L1).*atan(d.*L1.^(-1))+101606400.*d.*k.*(d+ ...
        sqrt(-1).*L1).*atan(d.*L1.^(-1))+(sqrt(-1)*(-101606400)).*d.^2.* ...
        k.*log(d.^2)+(sqrt(-1)*50803200).*d.*k.*(d+sqrt(-1).*L1).*log( ...
        d.^2+L1.^2)+50803200.*d.*k.*(sqrt(-1).*d+L1).*log(d.^2+L1.^2)+( ...
        -315).*((-645120)+(-161280).*d.^2.*k.^2+3360.*d.^4.*k.^4+(-56).* ...
        d.^6.*k.^6+5.*d.^8.*k.^8).*L1.*log((-1).*L1+(d.^2+L1.^2).^(1/2)))+ ...
        (1/812851200).*k.^2.*pi.^(-1).*(3.*((-240).*d.^8.*k.^8+d.^6.*( ...
        5376.*k.^6+435.*k.^8.*(L1+(-1).*L2).^2)+2.*d.^4.*k.^4.*((-188160)+ ...
        1596.*k.^2.*(L1+(-1).*L2).^2+95.*k.^4.*(L1+(-1).*L2).^4)+2240.*( ...
        60480+2520.*k.^2.*(L1+(-1).*L2).^2+(-63).*k.^4.*(L1+(-1).*L2).^4+ ...
        k.^6.*(L1+(-1).*L2).^6)+8.*d.^2.*k.^2.*(2822400+(-20580).*k.^2.*( ...
        L1+(-1).*L2).^2+742.*k.^4.*(L1+(-1).*L2).^4+5.*k.^6.*(L1+(-1).*L2) ...
        .^6)).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+(sqrt(-1)*16).*k.*L1.*(35.* ...
        d.^8.*k.^8+35.*d.^6.*k.^8.*L1.^2+21.*d.^4.*k.^6.*L1.^2.*(40+k.^2.* ...
        L1.^2)+d.^2.*k.^4.*L1.^2.*((-35280)+1008.*k.^2.*L1.^2+5.*k.^4.* ...
        L1.^4)+72.*((-176400)+9800.*k.^2.*L1.^2+(-294).*k.^4.*L1.^4+5.* ...
        k.^6.*L1.^6)).*L2+(sqrt(-1)*(-280)).*k.^3.*L1.^2.*(3.*d.^6.*k.^6+ ...
        3.*d.^4.*k.^4.*(24+k.^2.*L1.^2)+72.*(840+(-42).*k.^2.*L1.^2+k.^4.* ...
        L1.^4)+d.^2.*k.^2.*((-3024)+144.*k.^2.*L1.^2+k.^4.*L1.^4)).*L2.^2+ ...
        (sqrt(-1)*560).*k.^3.*L1.*(d.^6.*k.^6+2.*d.^4.*k.^4.*(12+k.^2.* ...
        L1.^2)+72.*(280+(-28).*k.^2.*L1.^2+k.^4.*L1.^4)+d.^2.*k.^2.*(( ...
        -1008)+96.*k.^2.*L1.^2+k.^4.*L1.^4)).*L2.^3+(sqrt(-1)*(-140)).* ...
        k.^5.*L1.^2.*(6.*d.^4.*k.^4+72.*((-84)+5.*k.^2.*L1.^2)+d.^2.* ...
        k.^2.*(288+5.*k.^2.*L1.^2)).*L2.^4+(sqrt(-1)*112).*k.^5.*L1.*(3.* ...
        d.^4.*k.^4+72.*((-42)+5.*k.^2.*L1.^2)+d.^2.*k.^2.*(144+5.*k.^2.* ...
        L1.^2)).*L2.^5+(sqrt(-1)*(-280)).*k.^7.*(72+d.^2.*k.^2).*L1.^2.* ...
        L2.^6+(sqrt(-1)*80).*k.^7.*(72+d.^2.*k.^2).*L1.*L2.^7+(-3).*(d.^2+ ...
        L2.^2).^(1/2).*((-240).*d.^8.*k.^8+d.^6.*(5376.*k.^6+435.*k.^8.* ...
        L2.^2)+2.*d.^4.*k.^4.*((-188160)+1596.*k.^2.*L2.^2+95.*k.^4.* ...
        L2.^4)+2240.*(60480+2520.*k.^2.*L2.^2+(-63).*k.^4.*L2.^4+k.^6.* ...
        L2.^6)+8.*d.^2.*k.^2.*(2822400+(-20580).*k.^2.*L2.^2+742.*k.^4.* ...
        L2.^4+5.*k.^6.*L2.^6))+101606400.*d.*k.*(d+sqrt(-1).*L1).*atan(d.* ...
        (L1+(-1).*L2).^(-1))+(sqrt(-1)*203212800).*d.*k.*L2.*atan(d.^(-1) ...
        .*(L1+(-1).*L2))+(sqrt(-1)*203212800).*d.*k.*L2.*atan(d.^(-1).*L2) ...
        +101606400.*d.*k.*(d+(sqrt(-1)*(-1)).*L1).*atan(d.*((-1).*L1+L2) ...
        .^(-1))+(sqrt(-1)*50803200).*d.*k.*(d+sqrt(-1).*L1).*log(d.^2+(L1+ ...
        (-1).*L2).^2)+50803200.*d.*k.*(sqrt(-1).*d+L1).*log(d.^2+(L1+(-1) ...
        .*L2).^2)+(-315).*((-645120)+(-161280).*d.^2.*k.^2+3360.*d.^4.* ...
        k.^4+(-56).*d.^6.*k.^6+5.*d.^8.*k.^8).*L2.*log(L1+(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2)+(-1).*L2)+(-315).*((-645120)+(-161280).*d.^2.*k.^2+ ...
        3360.*d.^4.*k.^4+(-56).*d.^6.*k.^6+5.*d.^8.*k.^8).*L1.*log((-1).* ...
        L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+L2)+(sqrt(-1)*(-101606400)).* ...
        d.^2.*k.*log(d.^2+L2.^2)+315.*((-645120)+(-161280).*d.^2.*k.^2+ ...
        3360.*d.^4.*k.^4+(-56).*d.^6.*k.^6+5.*d.^8.*k.^8).*L2.*log((-1).* ...
        L2+(d.^2+L2.^2).^(1/2)));
elseif order == 9
    H3_total=(1/442597478400).*(d.^2).^(1/2).*k.^2.*(221298739200+36883123200.* ...
        d.^2.*k.^2+(-614718720).*d.^4.*k.^4+8781696.*d.^6.*k.^6+(-87120).* ...
        d.^8.*k.^8+616.*d.^10.*k.^10+(-21).*d.^12.*k.^12).*pi.^(-1)+( ...
        -1/566524772352000).*k.^2.*(d.^2+L1.^2).^(1/2).*(283262386176000+ ...
        47210397696000.*d.^2.*k.^2+(-786839961600).*d.^4.*k.^4+ ...
        11240570880.*d.^6.*k.^6+(-111513600).*d.^8.*k.^8+788480.*d.^10.* ...
        k.^10+(-26880).*d.^12.*k.^12+11802599424000.*k.^2.*L1.^2+( ...
        -344242483200).*d.^2.*k.^4.*L1.^2+6674088960.*d.^4.*k.^6.*L1.^2+( ...
        -81457200).*d.^6.*k.^8.*L1.^2+672980.*d.^8.*k.^10.*L1.^2+88515.* ...
        d.^10.*k.^12.*L1.^2+(-295064985600).*k.^4.*L1.^4+12411463680.* ...
        d.^2.*k.^6.*L1.^4+(-243064800).*d.^4.*k.^8.*L1.^4+2836680.*d.^6.* ...
        k.^10.*L1.^4+75390.*d.^8.*k.^12.*L1.^4+4683571200.*k.^6.*L1.^6+( ...
        -184694400).*d.^2.*k.^8.*L1.^6+3250016.*d.^4.*k.^10.*L1.^6+47208.* ...
        d.^6.*k.^12.*L1.^6+(-48787200).*k.^8.*L1.^8+1719872.*d.^2.*k.^10.* ...
        L1.^8+17136.*d.^4.*k.^12.*L1.^8+354816.*k.^10.*L1.^10+2688.*d.^2.* ...
        k.^12.*L1.^10).*pi.^(-1)+(1/1916006400).*k.^2.*((sqrt(-1)*(-8/5)) ...
        .*(169.*d.^10.*k.^11.*L1+110.*d.^8.*k.^11.*L1.^3+(-372).*d.^6.* ...
        k.^11.*L1.^5)+(sqrt(-1)*(1488/35)).*(3.*d.^10.*k.^11.*L1+(-10).* ...
        d.^8.*k.^11.*L1.^3+3.*d.^6.*k.^11.*L1.^5)+(sqrt(-1)*(-32/21)).*( ...
        3740.*d.^8.*k.^9.*L1+43.*d.^10.*k.^11.*L1+(-26180).*d.^6.*k.^9.* ...
        L1.^3+(-301).*d.^8.*k.^11.*L1.^3+26180.*d.^4.*k.^9.*L1.^5+301.* ...
        d.^6.*k.^11.*L1.^5+(-3740).*d.^2.*k.^9.*L1.^7+(-43).*d.^4.*k.^11.* ...
        L1.^7)+(sqrt(-1)*(12/7)).*((-188496).*d.^6.*k.^7.*L1+8492.*d.^8.* ...
        k.^9.*L1+43.*d.^10.*k.^11.*L1+(-55440).*d.^4.*k.^7.*L1.^3+(-4620) ...
        .*d.^6.*k.^9.*L1.^3+129.*d.^8.*k.^11.*L1.^3+3470544.*d.^2.*k.^7.* ...
        L1.^5+(-163548).*d.^4.*k.^9.*L1.^5+(-1935).*d.^6.*k.^11.*L1.^5+( ...
        -990000).*k.^7.*L1.^7+48620.*d.^2.*k.^9.*L1.^7+559.*d.^4.*k.^11.* ...
        L1.^7)+(sqrt(-1)*(-4/3)).*(110.*d.^8.*k.^9.*L1+d.^10.*k.^11.*L1+ ...
        18040.*d.^6.*k.^9.*L1.^3+164.*d.^8.*k.^11.*L1.^3+(-214060).*d.^4.* ...
        k.^9.*L1.^5+(-1946).*d.^6.*k.^11.*L1.^5+250360.*d.^2.*k.^9.*L1.^7+ ...
        2276.*d.^4.*k.^11.*L1.^7+(-32560).*k.^9.*L1.^9+(-296).*d.^2.* ...
        k.^11.*L1.^9)+(sqrt(-1)*(-4)).*(119750400.*k.*L1+(-80784).*d.^6.* ...
        k.^7.*L1+2178.*d.^8.*k.^9.*L1+(-31).*d.^10.*k.^11.*L1+(-6652800).* ...
        k.^3.*L1.^3+332640.*d.^2.*k.^5.*L1.^3+(-31680).*d.^4.*k.^7.*L1.^3+ ...
        2090.*d.^6.*k.^9.*L1.^3+(-31).*d.^8.*k.^11.*L1.^3+199584.*k.^5.* ...
        L1.^5+1477872.*d.^2.*k.^7.*L1.^5+(-8514).*d.^4.*k.^9.*L1.^5+(-111) ...
        .*d.^6.*k.^11.*L1.^5+(-427680).*k.^7.*L1.^7+(-61050).*d.^2.*k.^9.* ...
        L1.^7+(-501).*d.^4.*k.^11.*L1.^7+10890.*k.^9.*L1.^9+99.*d.^2.* ...
        k.^11.*L1.^9)).*L2.*pi.^(-1)+(sqrt(-1)*(-1/319334400)).*k.^3.*( ...
        39916800+d.^10.*k.^10).*L2.^2.*pi.^(-1)+(sqrt(-1)*(1/319334400)).* ...
        k.^2.*(39916800.*k+d.^10.*k.^11+(-6652800).*k.^3.*L1.^2+332640.* ...
        d.^2.*k.^5.*L1.^2+(-7920).*d.^4.*k.^7.*L1.^2+110.*d.^6.*k.^9.* ...
        L1.^2+4.*d.^8.*k.^11.*L1.^2+332640.*k.^5.*L1.^4+(-15840).*d.^2.* ...
        k.^7.*L1.^4+330.*d.^4.*k.^9.*L1.^4+6.*d.^6.*k.^11.*L1.^4+(-7920).* ...
        k.^7.*L1.^6+330.*d.^2.*k.^9.*L1.^6+4.*d.^4.*k.^11.*L1.^6+110.* ...
        k.^9.*L1.^8+d.^2.*k.^11.*L1.^8).*L2.^2.*pi.^(-1)+(sqrt(-1)*( ...
        -1/239500800)).*k.^2.*((-3326400).*k.^3.*L1+166320.*d.^2.*k.^5.* ...
        L1+(-3960).*d.^4.*k.^7.*L1+55.*d.^6.*k.^9.*L1+2.*d.^8.*k.^11.*L1+ ...
        332640.*k.^5.*L1.^3+(-15840).*d.^2.*k.^7.*L1.^3+330.*d.^4.*k.^9.* ...
        L1.^3+6.*d.^6.*k.^11.*L1.^3+(-11880).*k.^7.*L1.^5+495.*d.^2.* ...
        k.^9.*L1.^5+6.*d.^4.*k.^11.*L1.^5+220.*k.^9.*L1.^7+2.*d.^2.* ...
        k.^11.*L1.^7).*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/958003200)).*k.^5.*(( ...
        -3326400)+166320.*d.^2.*k.^2+(-3960).*d.^4.*k.^4+55.*d.^6.*k.^6+ ...
        2.*d.^8.*k.^8).*L2.^4.*pi.^(-1)+(sqrt(-1)*(1/958003200)).*k.^2.*(( ...
        -3326400).*k.^3+166320.*d.^2.*k.^5+(-3960).*d.^4.*k.^7+55.*d.^6.* ...
        k.^9+2.*d.^8.*k.^11+997920.*k.^5.*L1.^2+(-47520).*d.^2.*k.^7.* ...
        L1.^2+990.*d.^4.*k.^9.*L1.^2+18.*d.^6.*k.^11.*L1.^2+(-59400).* ...
        k.^7.*L1.^4+2475.*d.^2.*k.^9.*L1.^4+30.*d.^4.*k.^11.*L1.^4+1540.* ...
        k.^9.*L1.^6+14.*d.^2.*k.^11.*L1.^6).*L2.^4.*pi.^(-1)+(sqrt(-1)*( ...
        -1/399168000)).*k.^2.*(166320.*k.^5.*L1+(-7920).*d.^2.*k.^7.*L1+ ...
        165.*d.^4.*k.^9.*L1+3.*d.^6.*k.^11.*L1+(-19800).*k.^7.*L1.^3+825.* ...
        d.^2.*k.^9.*L1.^3+10.*d.^4.*k.^11.*L1.^3+770.*k.^9.*L1.^5+7.* ...
        d.^2.*k.^11.*L1.^5).*L2.^5.*pi.^(-1)+(sqrt(-1)*(-1/798336000)).* ...
        k.^7.*(55440+(-2640).*d.^2.*k.^2+55.*d.^4.*k.^4+d.^6.*k.^6).* ...
        L2.^6.*pi.^(-1)+(sqrt(-1)*(1/2395008000)).*k.^7.*(166320+(-7920).* ...
        d.^2.*k.^2+165.*d.^4.*k.^4+3.*d.^6.*k.^6+(-59400).*k.^2.*L1.^2+ ...
        2475.*d.^2.*k.^4.*L1.^2+30.*d.^4.*k.^6.*L1.^2+3850.*k.^4.*L1.^4+ ...
        35.*d.^2.*k.^6.*L1.^4).*L2.^6.*pi.^(-1)+(sqrt(-1)*(-1/1676505600)) ...
        .*k.^9.*L1.*((-11880)+495.*d.^2.*k.^2+6.*d.^4.*k.^4+1540.*k.^2.* ...
        L1.^2+14.*d.^2.*k.^4.*L1.^2).*L2.^7.*pi.^(-1)+(sqrt(-1)*( ...
        -1/4470681600)).*k.^9.*((-3960)+165.*d.^2.*k.^2+2.*d.^4.*k.^4).* ...
        L2.^8.*pi.^(-1)+(sqrt(-1)*(1/4470681600)).*k.^9.*((-3960)+165.* ...
        d.^2.*k.^2+2.*d.^4.*k.^4+1540.*k.^2.*L1.^2+14.*d.^2.*k.^4.*L1.^2) ...
        .*L2.^8.*pi.^(-1)+(sqrt(-1)*(-1/1437004800)).*k.^11.*(110+d.^2.* ...
        k.^2).*L1.*L2.^9.*pi.^(-1)+(-1/1916006400).*k.^2.*(d.^2+L2.^2).^( ...
        1/2).*((1/231).*(221298739200+36883123200.*d.^2.*k.^2+(-614718720) ...
        .*d.^4.*k.^4+8781696.*d.^6.*k.^6+(-87120).*d.^8.*k.^8+616.*d.^10.* ...
        k.^10+(-21).*d.^12.*k.^12)+(1/59136).*k.^2.*(2360519884800+( ...
        -68848496640).*d.^2.*k.^2+1334817792.*d.^4.*k.^4+(-16291440).* ...
        d.^6.*k.^6+134596.*d.^8.*k.^8+17703.*d.^10.*k.^10).*L2.^2+(1/9856) ...
        .*k.^4.*((-9835499520)+413715456.*d.^2.*k.^2+(-8102160).*d.^4.* ...
        k.^4+94556.*d.^6.*k.^6+2513.*d.^8.*k.^8).*L2.^4+(1/36960).*k.^6.*( ...
        585446400+(-23086800).*d.^2.*k.^2+406252.*d.^4.*k.^4+5901.*d.^6.* ...
        k.^6).*L2.^6+(1/2640).*k.^8.*((-435600)+15356.*d.^2.*k.^2+153.* ...
        d.^4.*k.^4).*L2.^8+(1/110).*k.^10.*(132+d.^2.*k.^2).*L2.^10).* ...
        pi.^(-1)+(1/1916006400).*k.^2.*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^( ...
        1/2).*((1/295680).*(283262386176000+47210397696000.*d.^2.*k.^2+( ...
        -786839961600).*d.^4.*k.^4+11240570880.*d.^6.*k.^6+(-111513600).* ...
        d.^8.*k.^8+788480.*d.^10.*k.^10+(-26880).*d.^12.*k.^12+ ...
        11802599424000.*k.^2.*L1.^2+(-344242483200).*d.^2.*k.^4.*L1.^2+ ...
        6674088960.*d.^4.*k.^6.*L1.^2+(-81457200).*d.^6.*k.^8.*L1.^2+ ...
        672980.*d.^8.*k.^10.*L1.^2+88515.*d.^10.*k.^12.*L1.^2+( ...
        -295064985600).*k.^4.*L1.^4+12411463680.*d.^2.*k.^6.*L1.^4+( ...
        -243064800).*d.^4.*k.^8.*L1.^4+2836680.*d.^6.*k.^10.*L1.^4+75390.* ...
        d.^8.*k.^12.*L1.^4+4683571200.*k.^6.*L1.^6+(-184694400).*d.^2.* ...
        k.^8.*L1.^6+3250016.*d.^4.*k.^10.*L1.^6+47208.*d.^6.*k.^12.*L1.^6+ ...
        (-48787200).*k.^8.*L1.^8+1719872.*d.^2.*k.^10.*L1.^8+17136.*d.^4.* ...
        k.^12.*L1.^8+354816.*k.^10.*L1.^10+2688.*d.^2.*k.^12.*L1.^10)+( ...
        -1/147840).*k.^2.*L1.*(11802599424000+(-344242483200).*d.^2.*k.^2+ ...
        6674088960.*d.^4.*k.^4+(-81457200).*d.^6.*k.^6+672980.*d.^8.*k.^8+ ...
        88515.*d.^10.*k.^10+(-590129971200).*k.^2.*L1.^2+24822927360.* ...
        d.^2.*k.^4.*L1.^2+(-486129600).*d.^4.*k.^6.*L1.^2+5673360.*d.^6.* ...
        k.^8.*L1.^2+150780.*d.^8.*k.^10.*L1.^2+14050713600.*k.^4.*L1.^4+( ...
        -554083200).*d.^2.*k.^6.*L1.^4+9750048.*d.^4.*k.^8.*L1.^4+141624.* ...
        d.^6.*k.^10.*L1.^4+(-195148800).*k.^6.*L1.^6+6879488.*d.^2.*k.^8.* ...
        L1.^6+68544.*d.^4.*k.^10.*L1.^6+1774080.*k.^8.*L1.^8+13440.*d.^2.* ...
        k.^10.*L1.^8).*L2+(1/295680).*k.^2.*(11802599424000+( ...
        -344242483200).*d.^2.*k.^2+6674088960.*d.^4.*k.^4+(-81457200).* ...
        d.^6.*k.^6+672980.*d.^8.*k.^8+88515.*d.^10.*k.^10+(-1770389913600) ...
        .*k.^2.*L1.^2+74468782080.*d.^2.*k.^4.*L1.^2+(-1458388800).*d.^4.* ...
        k.^6.*L1.^2+17020080.*d.^6.*k.^8.*L1.^2+452340.*d.^8.*k.^10.* ...
        L1.^2+70253568000.*k.^4.*L1.^4+(-2770416000).*d.^2.*k.^6.*L1.^4+ ...
        48750240.*d.^4.*k.^8.*L1.^4+708120.*d.^6.*k.^10.*L1.^4+( ...
        -1366041600).*k.^6.*L1.^6+48156416.*d.^2.*k.^8.*L1.^6+479808.* ...
        d.^4.*k.^10.*L1.^6+15966720.*k.^8.*L1.^8+120960.*d.^2.*k.^10.* ...
        L1.^8).*L2.^2+(-1/36960).*k.^4.*L1.*((-147532492800)+6205731840.* ...
        d.^2.*k.^2+(-121532400).*d.^4.*k.^4+1418340.*d.^6.*k.^6+37695.* ...
        d.^8.*k.^8+11708928000.*k.^2.*L1.^2+(-461736000).*d.^2.*k.^4.* ...
        L1.^2+8125040.*d.^4.*k.^6.*L1.^2+118020.*d.^6.*k.^8.*L1.^2+( ...
        -341510400).*k.^4.*L1.^4+12039104.*d.^2.*k.^6.*L1.^4+119952.* ...
        d.^4.*k.^8.*L1.^4+5322240.*k.^6.*L1.^6+40320.*d.^2.*k.^8.*L1.^6).* ...
        L2.^3+(1/29568).*k.^4.*((-29506498560)+1241146368.*d.^2.*k.^2+( ...
        -24306480).*d.^4.*k.^4+283668.*d.^6.*k.^6+7539.*d.^8.*k.^8+ ...
        7025356800.*k.^2.*L1.^2+(-277041600).*d.^2.*k.^4.*L1.^2+4875024.* ...
        d.^4.*k.^6.*L1.^2+70812.*d.^6.*k.^8.*L1.^2+(-341510400).*k.^4.* ...
        L1.^4+12039104.*d.^2.*k.^6.*L1.^4+119952.*d.^4.*k.^8.*L1.^4+ ...
        7451136.*k.^6.*L1.^6+56448.*d.^2.*k.^8.*L1.^6).*L2.^4+(-1/18480).* ...
        k.^6.*L1.*(1756339200+(-69260400).*d.^2.*k.^2+1218756.*d.^4.*k.^4+ ...
        17703.*d.^6.*k.^6+(-170755200).*k.^2.*L1.^2+6019552.*d.^2.*k.^4.* ...
        L1.^2+59976.*d.^4.*k.^6.*L1.^2+5588352.*k.^4.*L1.^4+42336.*d.^2.* ...
        k.^6.*L1.^4).*L2.^5+(1/36960).*k.^6.*(585446400+(-23086800).* ...
        d.^2.*k.^2+406252.*d.^4.*k.^4+5901.*d.^6.*k.^6+(-170755200).* ...
        k.^2.*L1.^2+6019552.*d.^2.*k.^4.*L1.^2+59976.*d.^4.*k.^6.*L1.^2+ ...
        9313920.*k.^4.*L1.^4+70560.*d.^2.*k.^6.*L1.^4).*L2.^6+(-1/330).* ...
        k.^8.*L1.*((-435600)+15356.*d.^2.*k.^2+153.*d.^4.*k.^4+47520.* ...
        k.^2.*L1.^2+360.*d.^2.*k.^4.*L1.^2).*L2.^7+(1/2640).*k.^8.*(( ...
        -435600)+15356.*d.^2.*k.^2+153.*d.^4.*k.^4+142560.*k.^2.*L1.^2+ ...
        1080.*d.^2.*k.^4.*L1.^2).*L2.^8+(-1/11).*k.^10.*(132+d.^2.*k.^2).* ...
        L1.*L2.^9+(1/110).*k.^10.*(132+d.^2.*k.^2).*L2.^10).*pi.^(-1)+( ...
        1/8).*k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1).*pi.^(-1).*atan( ...
        d.*L1.^(-1))+(-1/8).*k.^2.*(d.^2.*k+sqrt(-1).*d.*k.*L1).*pi.^(-1) ...
        .*atan(d.*L1.^(-1))+(sqrt(-1)*(1/4)).*d.*k.^3.*L2.*pi.^(-1).*atan( ...
        d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*(1/4)).*d.*k.^3.*L2.*pi.^(-1).* ...
        atan(d.^(-1).*L2)+(1/8).*k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1) ...
        .*pi.^(-1).*atan(d.*((-1).*L1+L2).^(-1))+(-1/8).*k.^2.*(d.^2.*k+ ...
        sqrt(-1).*d.*k.*L1).*pi.^(-1).*atan(d.*((-1).*L1+L2).^(-1))+(sqrt( ...
        -1)*(1/8)).*d.^2.*k.^3.*pi.^(-1).*log(d.^2)+(sqrt(-1)*(-1/16)).* ...
        k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1).*pi.^(-1).*log(d.^2+ ...
        L1.^2)+(sqrt(-1)*(-1/16)).*k.^2.*(d.^2.*k+sqrt(-1).*d.*k.*L1).* ...
        pi.^(-1).*log(d.^2+L1.^2)+(1/163499212800).*k.^2.*((-40874803200)+ ...
        (-10218700800).*d.^2.*k.^2+212889600.*d.^4.*k.^4+(-3548160).* ...
        d.^6.*k.^6+39600.*d.^8.*k.^8+(-308).*d.^10.*k.^10+21.*d.^12.* ...
        k.^12).*L1.*pi.^(-1).*log((-1).*L1+(d.^2+L1.^2).^(1/2))+(sqrt(-1)* ...
        (-1/8)).*d.^2.*k.^3.*pi.^(-1).*log(d.^2+L2.^2)+(sqrt(-1)*(1/16)).* ...
        k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1).*pi.^(-1).*log(d.^2+ ...
        L1.^2+(-2).*L1.*L2+L2.^2)+(sqrt(-1)*(1/16)).*k.^2.*(d.^2.*k+sqrt( ...
        -1).*d.*k.*L1).*pi.^(-1).*log(d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+( ...
        1/163499212800).*k.^2.*((-40874803200)+(-10218700800).*d.^2.*k.^2+ ...
        212889600.*d.^4.*k.^4+(-3548160).*d.^6.*k.^6+39600.*d.^8.*k.^8+( ...
        -308).*d.^10.*k.^10+21.*d.^12.*k.^12).*L2.*pi.^(-1).*log((-1).*L2+ ...
        (d.^2+L2.^2).^(1/2))+(-1/163499212800).*k.^2.*((-40874803200)+( ...
        -10218700800).*d.^2.*k.^2+212889600.*d.^4.*k.^4+(-3548160).*d.^6.* ...
        k.^6+39600.*d.^8.*k.^8+(-308).*d.^10.*k.^10+21.*d.^12.*k.^12).* ...
        L2.*pi.^(-1).*log(L1+(-1).*L2+(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^( ...
        1/2))+(-1/163499212800).*k.^2.*((-40874803200)+(-10218700800).* ...
        d.^2.*k.^2+212889600.*d.^4.*k.^4+(-3548160).*d.^6.*k.^6+39600.* ...
        d.^8.*k.^8+(-308).*d.^10.*k.^10+21.*d.^12.*k.^12).*L1.*pi.^(-1).* ...
        log((-1).*L1+L2+(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(1/2));
elseif order == 10
    H3_total=(-1/442597478400).*(d.^2).^(1/2).*k.^2.*((-221298739200)+( ...
        -36883123200).*d.^2.*k.^2+614718720.*d.^4.*k.^4+(-8781696).*d.^6.* ...
        k.^6+87120.*d.^8.*k.^8+(-616).*d.^10.*k.^10+21.*d.^12.*k.^12).* ...
        pi.^(-1)+(1/566524772352000).*k.^2.*(d.^2+L1.^2).^(1/2).*(( ...
        -283262386176000)+(-47210397696000).*d.^2.*k.^2+786839961600.* ...
        d.^4.*k.^4+(-11240570880).*d.^6.*k.^6+111513600.*d.^8.*k.^8+( ...
        -788480).*d.^10.*k.^10+26880.*d.^12.*k.^12+(-11802599424000).* ...
        k.^2.*L1.^2+344242483200.*d.^2.*k.^4.*L1.^2+(-6674088960).*d.^4.* ...
        k.^6.*L1.^2+81457200.*d.^6.*k.^8.*L1.^2+(-672980).*d.^8.*k.^10.* ...
        L1.^2+(-88515).*d.^10.*k.^12.*L1.^2+295064985600.*k.^4.*L1.^4+( ...
        -12411463680).*d.^2.*k.^6.*L1.^4+243064800.*d.^4.*k.^8.*L1.^4+( ...
        -2836680).*d.^6.*k.^10.*L1.^4+(-75390).*d.^8.*k.^12.*L1.^4+( ...
        -4683571200).*k.^6.*L1.^6+184694400.*d.^2.*k.^8.*L1.^6+(-3250016) ...
        .*d.^4.*k.^10.*L1.^6+(-47208).*d.^6.*k.^12.*L1.^6+48787200.*k.^8.* ...
        L1.^8+(-1719872).*d.^2.*k.^10.*L1.^8+(-17136).*d.^4.*k.^12.*L1.^8+ ...
        (-354816).*k.^10.*L1.^10+(-2688).*d.^2.*k.^12.*L1.^10).*pi.^(-1)+( ...
        1/24908083200).*k.^2.*((sqrt(-1)*(104/5)).*(121.*d.^10.*k.^11.*L1+ ...
        140.*d.^8.*k.^11.*L1.^3+(-348).*d.^6.*k.^11.*L1.^5)+(sqrt(-1)*( ...
        -18096/35)).*(3.*d.^10.*k.^11.*L1+(-10).*d.^8.*k.^11.*L1.^3+3.* ...
        d.^6.*k.^11.*L1.^5)+(sqrt(-1)*(832/21)).*((-1870).*d.^8.*k.^9.*L1+ ...
        41.*d.^10.*k.^11.*L1+13090.*d.^6.*k.^9.*L1.^3+(-287).*d.^8.* ...
        k.^11.*L1.^3+(-13090).*d.^4.*k.^9.*L1.^5+287.*d.^6.*k.^11.*L1.^5+ ...
        1870.*d.^2.*k.^9.*L1.^7+(-41).*d.^4.*k.^11.*L1.^7)+(sqrt(-1)*( ...
        1000/63)).*(d.^12.*k.^13.*L1+(-7).*d.^10.*k.^13.*L1.^3+7.*d.^8.* ...
        k.^13.*L1.^5+(-1).*d.^6.*k.^13.*L1.^7)+(sqrt(-1)*(-1/7)).*( ...
        29405376.*d.^6.*k.^7.*L1+(-1324752).*d.^8.*k.^9.*L1+12792.*d.^10.* ...
        k.^11.*L1+269.*d.^12.*k.^13.*L1+8648640.*d.^4.*k.^7.*L1.^3+ ...
        720720.*d.^6.*k.^9.*L1.^3+38376.*d.^8.*k.^11.*L1.^3+(-105).* ...
        d.^10.*k.^13.*L1.^3+(-541404864).*d.^2.*k.^7.*L1.^5+25513488.* ...
        d.^4.*k.^9.*L1.^5+(-575640).*d.^6.*k.^11.*L1.^5+(-5481).*d.^8.* ...
        k.^13.*L1.^5+154440000.*k.^7.*L1.^7+(-7584720).*d.^2.*k.^9.*L1.^7+ ...
        166296.*d.^4.*k.^11.*L1.^7+1625.*d.^6.*k.^13.*L1.^7)+(sqrt(-1)*( ...
        -5512/33)).*(5.*d.^10.*k.^11.*L1+(-60).*d.^8.*k.^11.*L1.^3+126.* ...
        d.^6.*k.^11.*L1.^5+(-60).*d.^4.*k.^11.*L1.^7+5.*d.^2.*k.^11.* ...
        L1.^9)+(sqrt(-1)*(-1/3)).*(5720.*d.^8.*k.^9.*L1+(-2756).*d.^10.* ...
        k.^11.*L1+27.*d.^12.*k.^13.*L1+938080.*d.^6.*k.^9.*L1.^3+(-11024) ...
        .*d.^8.*k.^11.*L1.^3+(-191).*d.^10.*k.^13.*L1.^3+(-11131120).* ...
        d.^4.*k.^9.*L1.^5+424424.*d.^6.*k.^11.*L1.^5+1224.*d.^8.*k.^13.* ...
        L1.^5+13018720.*d.^2.*k.^9.*L1.^7+(-540176).*d.^4.*k.^11.*L1.^7+ ...
        2916.*d.^6.*k.^13.*L1.^7+(-1693120).*k.^9.*L1.^9+71656.*d.^2.* ...
        k.^11.*L1.^9+(-576).*d.^4.*k.^13.*L1.^9)+(sqrt(-1)*(64/9)).*( ...
        d.^12.*k.^13.*L1+4.*d.^10.*k.^13.*L1.^3+(-154).*d.^8.*k.^13.* ...
        L1.^5+196.*d.^6.*k.^13.*L1.^7+(-26).*d.^4.*k.^13.*L1.^9)+(sqrt(-1) ...
        *(-128/99)).*(5.*d.^12.*k.^13.*L1+(-60).*d.^10.*k.^13.*L1.^3+126.* ...
        d.^8.*k.^13.*L1.^5+(-60).*d.^6.*k.^13.*L1.^7+5.*d.^4.*k.^13.* ...
        L1.^9)+sqrt(-1).*((-6227020800).*k.*L1+4200768.*d.^6.*k.^7.*L1+( ...
        -113256).*d.^8.*k.^9.*L1+(-832).*d.^10.*k.^11.*L1+32.*d.^12.* ...
        k.^13.*L1+345945600.*k.^3.*L1.^3+(-17297280).*d.^2.*k.^5.*L1.^3+ ...
        1647360.*d.^4.*k.^7.*L1.^3+(-108680).*d.^6.*k.^9.*L1.^3+(-832).* ...
        d.^8.*k.^11.*L1.^3+(-46).*d.^10.*k.^13.*L1.^3+(-10378368).*k.^5.* ...
        L1.^5+(-76849344).*d.^2.*k.^7.*L1.^5+442728.*d.^4.*k.^9.*L1.^5+( ...
        -5304).*d.^6.*k.^11.*L1.^5+241.*d.^8.*k.^13.*L1.^5+22239360.* ...
        k.^7.*L1.^7+3174600.*d.^2.*k.^9.*L1.^7+40248.*d.^4.*k.^11.*L1.^7+ ...
        1063.*d.^6.*k.^13.*L1.^7+(-566280).*k.^9.*L1.^9+(-80652).*d.^2.* ...
        k.^11.*L1.^9+(-676).*d.^4.*k.^13.*L1.^9+8112.*k.^11.*L1.^11+52.* ...
        d.^2.*k.^13.*L1.^11)+(sqrt(-1)*(-1/11)).*(156.*d.^10.*k.^11.*L1+ ...
        d.^12.*k.^13.*L1+44460.*d.^8.*k.^11.*L1.^3+285.*d.^10.*k.^13.* ...
        L1.^3+(-914472).*d.^6.*k.^11.*L1.^5+(-5862).*d.^8.*k.^13.*L1.^5+ ...
        2252952.*d.^4.*k.^11.*L1.^7+14442.*d.^6.*k.^13.*L1.^7+(-1159860).* ...
        d.^2.*k.^11.*L1.^9+(-7435).*d.^4.*k.^13.*L1.^9+89076.*k.^11.* ...
        L1.^11+571.*d.^2.*k.^13.*L1.^11)).*L2.*pi.^(-1)+(sqrt(-1)*( ...
        1/49816166400)).*k.^3.*((-6227020800)+d.^12.*k.^12).*L2.^2.*pi.^( ...
        -1)+(sqrt(-1)*(-1/49816166400)).*k.^2.*((-6227020800).*k+d.^12.* ...
        k.^13+1037836800.*k.^3.*L1.^2+(-51891840).*d.^2.*k.^5.*L1.^2+ ...
        1235520.*d.^4.*k.^7.*L1.^2+(-17160).*d.^6.*k.^9.*L1.^2+156.*d.^8.* ...
        k.^11.*L1.^2+5.*d.^10.*k.^13.*L1.^2+(-51891840).*k.^5.*L1.^4+ ...
        2471040.*d.^2.*k.^7.*L1.^4+(-51480).*d.^4.*k.^9.*L1.^4+624.*d.^6.* ...
        k.^11.*L1.^4+10.*d.^8.*k.^13.*L1.^4+1235520.*k.^7.*L1.^6+(-51480) ...
        .*d.^2.*k.^9.*L1.^6+936.*d.^4.*k.^11.*L1.^6+10.*d.^6.*k.^13.* ...
        L1.^6+(-17160).*k.^9.*L1.^8+624.*d.^2.*k.^11.*L1.^8+5.*d.^4.* ...
        k.^13.*L1.^8+156.*k.^11.*L1.^10+d.^2.*k.^13.*L1.^10).*L2.^2.*pi.^( ...
        -1)+(sqrt(-1)*(1/74724249600)).*k.^2.*(1037836800.*k.^3.*L1+( ...
        -51891840).*d.^2.*k.^5.*L1+1235520.*d.^4.*k.^7.*L1+(-17160).* ...
        d.^6.*k.^9.*L1+156.*d.^8.*k.^11.*L1+5.*d.^10.*k.^13.*L1+( ...
        -103783680).*k.^5.*L1.^3+4942080.*d.^2.*k.^7.*L1.^3+(-102960).* ...
        d.^4.*k.^9.*L1.^3+1248.*d.^6.*k.^11.*L1.^3+20.*d.^8.*k.^13.*L1.^3+ ...
        3706560.*k.^7.*L1.^5+(-154440).*d.^2.*k.^9.*L1.^5+2808.*d.^4.* ...
        k.^11.*L1.^5+30.*d.^6.*k.^13.*L1.^5+(-68640).*k.^9.*L1.^7+2496.* ...
        d.^2.*k.^11.*L1.^7+20.*d.^4.*k.^13.*L1.^7+780.*k.^11.*L1.^9+5.* ...
        d.^2.*k.^13.*L1.^9).*L2.^3.*pi.^(-1)+(sqrt(-1)*(1/298896998400)).* ...
        k.^5.*(1037836800+(-51891840).*d.^2.*k.^2+1235520.*d.^4.*k.^4+( ...
        -17160).*d.^6.*k.^6+156.*d.^8.*k.^8+5.*d.^10.*k.^10).*L2.^4.*pi.^( ...
        -1)+(sqrt(-1)*(-1/298896998400)).*k.^2.*(1037836800.*k.^3+( ...
        -51891840).*d.^2.*k.^5+1235520.*d.^4.*k.^7+(-17160).*d.^6.*k.^9+ ...
        156.*d.^8.*k.^11+5.*d.^10.*k.^13+(-311351040).*k.^5.*L1.^2+ ...
        14826240.*d.^2.*k.^7.*L1.^2+(-308880).*d.^4.*k.^9.*L1.^2+3744.* ...
        d.^6.*k.^11.*L1.^2+60.*d.^8.*k.^13.*L1.^2+18532800.*k.^7.*L1.^4+( ...
        -772200).*d.^2.*k.^9.*L1.^4+14040.*d.^4.*k.^11.*L1.^4+150.*d.^6.* ...
        k.^13.*L1.^4+(-480480).*k.^9.*L1.^6+17472.*d.^2.*k.^11.*L1.^6+ ...
        140.*d.^4.*k.^13.*L1.^6+7020.*k.^11.*L1.^8+45.*d.^2.*k.^13.*L1.^8) ...
        .*L2.^4.*pi.^(-1)+(sqrt(-1)*(1/62270208000)).*k.^2.*((-25945920).* ...
        k.^5.*L1+1235520.*d.^2.*k.^7.*L1+(-25740).*d.^4.*k.^9.*L1+312.* ...
        d.^6.*k.^11.*L1+5.*d.^8.*k.^13.*L1+3088800.*k.^7.*L1.^3+(-128700) ...
        .*d.^2.*k.^9.*L1.^3+2340.*d.^4.*k.^11.*L1.^3+25.*d.^6.*k.^13.* ...
        L1.^3+(-120120).*k.^9.*L1.^5+4368.*d.^2.*k.^11.*L1.^5+35.*d.^4.* ...
        k.^13.*L1.^5+2340.*k.^11.*L1.^7+15.*d.^2.*k.^13.*L1.^7).*L2.^5.* ...
        pi.^(-1)+(sqrt(-1)*(1/373621248000)).*k.^7.*((-25945920)+1235520.* ...
        d.^2.*k.^2+(-25740).*d.^4.*k.^4+312.*d.^6.*k.^6+5.*d.^8.*k.^8).* ...
        L2.^6.*pi.^(-1)+(sqrt(-1)*(-1/373621248000)).*k.^2.*((-25945920).* ...
        k.^5+1235520.*d.^2.*k.^7+(-25740).*d.^4.*k.^9+312.*d.^6.*k.^11+5.* ...
        d.^8.*k.^13+9266400.*k.^7.*L1.^2+(-386100).*d.^2.*k.^9.*L1.^2+ ...
        7020.*d.^4.*k.^11.*L1.^2+75.*d.^6.*k.^13.*L1.^2+(-600600).*k.^9.* ...
        L1.^4+21840.*d.^2.*k.^11.*L1.^4+175.*d.^4.*k.^13.*L1.^4+16380.* ...
        k.^11.*L1.^6+105.*d.^2.*k.^13.*L1.^6).*L2.^6.*pi.^(-1)+(sqrt(-1)*( ...
        1/261534873600)).*k.^2.*(1853280.*k.^7.*L1+(-77220).*d.^2.*k.^9.* ...
        L1+1404.*d.^4.*k.^11.*L1+15.*d.^6.*k.^13.*L1+(-240240).*k.^9.* ...
        L1.^3+8736.*d.^2.*k.^11.*L1.^3+70.*d.^4.*k.^13.*L1.^3+9828.* ...
        k.^11.*L1.^5+63.*d.^2.*k.^13.*L1.^5).*L2.^7.*pi.^(-1)+(sqrt(-1)*( ...
        1/697426329600)).*k.^9.*(617760+(-25740).*d.^2.*k.^2+468.*d.^4.* ...
        k.^4+5.*d.^6.*k.^6).*L2.^8.*pi.^(-1)+(sqrt(-1)*(-1/697426329600)) ...
        .*k.^2.*(617760.*k.^7+(-25740).*d.^2.*k.^9+468.*d.^4.*k.^11+5.* ...
        d.^6.*k.^13+(-240240).*k.^9.*L1.^2+8736.*d.^2.*k.^11.*L1.^2+70.* ...
        d.^4.*k.^13.*L1.^2+16380.*k.^11.*L1.^4+105.*d.^2.*k.^13.*L1.^4).* ...
        L2.^8.*pi.^(-1)+(sqrt(-1)*(1/224172748800)).*k.^11.*L1.*((-17160)+ ...
        624.*d.^2.*k.^2+5.*d.^4.*k.^4+2340.*k.^2.*L1.^2+15.*d.^2.*k.^4.* ...
        L1.^2).*L2.^9.*pi.^(-1)+(sqrt(-1)*(1/2241727488000)).*k.^11.*(( ...
        -17160)+624.*d.^2.*k.^2+5.*d.^4.*k.^4).*L2.^10.*pi.^(-1)+(sqrt(-1) ...
        *(-1/2241727488000)).*k.^11.*((-17160)+624.*d.^2.*k.^2+5.*d.^4.* ...
        k.^4+7020.*k.^2.*L1.^2+45.*d.^2.*k.^4.*L1.^2).*L2.^10.*pi.^(-1)+( ...
        sqrt(-1)*(1/273988915200)).*k.^13.*(156+d.^2.*k.^2).*L1.*L2.^11.* ...
        pi.^(-1)+(-1/24908083200).*k.^2.*(d.^2+L2.^2).^(1/2).*((-13/231).* ...
        ((-221298739200)+(-36883123200).*d.^2.*k.^2+614718720.*d.^4.*k.^4+ ...
        (-8781696).*d.^6.*k.^6+87120.*d.^8.*k.^8+(-616).*d.^10.*k.^10+21.* ...
        d.^12.*k.^12)+(13/59136).*k.^2.*(2360519884800+(-68848496640).* ...
        d.^2.*k.^2+1334817792.*d.^4.*k.^4+(-16291440).*d.^6.*k.^6+134596.* ...
        d.^8.*k.^8+17703.*d.^10.*k.^10).*L2.^2+(13/9856).*k.^4.*(( ...
        -9835499520)+413715456.*d.^2.*k.^2+(-8102160).*d.^4.*k.^4+94556.* ...
        d.^6.*k.^6+2513.*d.^8.*k.^8).*L2.^4+(13/36960).*k.^6.*(585446400+( ...
        -23086800).*d.^2.*k.^2+406252.*d.^4.*k.^4+5901.*d.^6.*k.^6).* ...
        L2.^6+(13/2640).*k.^8.*((-435600)+15356.*d.^2.*k.^2+153.*d.^4.* ...
        k.^4).*L2.^8+(13/110).*k.^10.*(132+d.^2.*k.^2).*L2.^10).*pi.^(-1)+ ...
        (1/24908083200).*k.^2.*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(1/2).*(( ...
        -13/295680).*((-283262386176000)+(-47210397696000).*d.^2.*k.^2+ ...
        786839961600.*d.^4.*k.^4+(-11240570880).*d.^6.*k.^6+111513600.* ...
        d.^8.*k.^8+(-788480).*d.^10.*k.^10+26880.*d.^12.*k.^12+( ...
        -11802599424000).*k.^2.*L1.^2+344242483200.*d.^2.*k.^4.*L1.^2+( ...
        -6674088960).*d.^4.*k.^6.*L1.^2+81457200.*d.^6.*k.^8.*L1.^2+( ...
        -672980).*d.^8.*k.^10.*L1.^2+(-88515).*d.^10.*k.^12.*L1.^2+ ...
        295064985600.*k.^4.*L1.^4+(-12411463680).*d.^2.*k.^6.*L1.^4+ ...
        243064800.*d.^4.*k.^8.*L1.^4+(-2836680).*d.^6.*k.^10.*L1.^4+( ...
        -75390).*d.^8.*k.^12.*L1.^4+(-4683571200).*k.^6.*L1.^6+184694400.* ...
        d.^2.*k.^8.*L1.^6+(-3250016).*d.^4.*k.^10.*L1.^6+(-47208).*d.^6.* ...
        k.^12.*L1.^6+48787200.*k.^8.*L1.^8+(-1719872).*d.^2.*k.^10.*L1.^8+ ...
        (-17136).*d.^4.*k.^12.*L1.^8+(-354816).*k.^10.*L1.^10+(-2688).* ...
        d.^2.*k.^12.*L1.^10)+(-13/147840).*k.^2.*L1.*(11802599424000+( ...
        -344242483200).*d.^2.*k.^2+6674088960.*d.^4.*k.^4+(-81457200).* ...
        d.^6.*k.^6+672980.*d.^8.*k.^8+88515.*d.^10.*k.^10+(-590129971200) ...
        .*k.^2.*L1.^2+24822927360.*d.^2.*k.^4.*L1.^2+(-486129600).*d.^4.* ...
        k.^6.*L1.^2+5673360.*d.^6.*k.^8.*L1.^2+150780.*d.^8.*k.^10.*L1.^2+ ...
        14050713600.*k.^4.*L1.^4+(-554083200).*d.^2.*k.^6.*L1.^4+9750048.* ...
        d.^4.*k.^8.*L1.^4+141624.*d.^6.*k.^10.*L1.^4+(-195148800).*k.^6.* ...
        L1.^6+6879488.*d.^2.*k.^8.*L1.^6+68544.*d.^4.*k.^10.*L1.^6+ ...
        1774080.*k.^8.*L1.^8+13440.*d.^2.*k.^10.*L1.^8).*L2+(13/295680).* ...
        k.^2.*(11802599424000+(-344242483200).*d.^2.*k.^2+6674088960.* ...
        d.^4.*k.^4+(-81457200).*d.^6.*k.^6+672980.*d.^8.*k.^8+88515.* ...
        d.^10.*k.^10+(-1770389913600).*k.^2.*L1.^2+74468782080.*d.^2.* ...
        k.^4.*L1.^2+(-1458388800).*d.^4.*k.^6.*L1.^2+17020080.*d.^6.* ...
        k.^8.*L1.^2+452340.*d.^8.*k.^10.*L1.^2+70253568000.*k.^4.*L1.^4+( ...
        -2770416000).*d.^2.*k.^6.*L1.^4+48750240.*d.^4.*k.^8.*L1.^4+ ...
        708120.*d.^6.*k.^10.*L1.^4+(-1366041600).*k.^6.*L1.^6+48156416.* ...
        d.^2.*k.^8.*L1.^6+479808.*d.^4.*k.^10.*L1.^6+15966720.*k.^8.* ...
        L1.^8+120960.*d.^2.*k.^10.*L1.^8).*L2.^2+(-13/36960).*k.^4.*L1.*(( ...
        -147532492800)+6205731840.*d.^2.*k.^2+(-121532400).*d.^4.*k.^4+ ...
        1418340.*d.^6.*k.^6+37695.*d.^8.*k.^8+11708928000.*k.^2.*L1.^2+( ...
        -461736000).*d.^2.*k.^4.*L1.^2+8125040.*d.^4.*k.^6.*L1.^2+118020.* ...
        d.^6.*k.^8.*L1.^2+(-341510400).*k.^4.*L1.^4+12039104.*d.^2.*k.^6.* ...
        L1.^4+119952.*d.^4.*k.^8.*L1.^4+5322240.*k.^6.*L1.^6+40320.*d.^2.* ...
        k.^8.*L1.^6).*L2.^3+(13/29568).*k.^4.*((-29506498560)+1241146368.* ...
        d.^2.*k.^2+(-24306480).*d.^4.*k.^4+283668.*d.^6.*k.^6+7539.*d.^8.* ...
        k.^8+7025356800.*k.^2.*L1.^2+(-277041600).*d.^2.*k.^4.*L1.^2+ ...
        4875024.*d.^4.*k.^6.*L1.^2+70812.*d.^6.*k.^8.*L1.^2+(-341510400).* ...
        k.^4.*L1.^4+12039104.*d.^2.*k.^6.*L1.^4+119952.*d.^4.*k.^8.*L1.^4+ ...
        7451136.*k.^6.*L1.^6+56448.*d.^2.*k.^8.*L1.^6).*L2.^4+(-13/18480) ...
        .*k.^6.*L1.*(1756339200+(-69260400).*d.^2.*k.^2+1218756.*d.^4.* ...
        k.^4+17703.*d.^6.*k.^6+(-170755200).*k.^2.*L1.^2+6019552.*d.^2.* ...
        k.^4.*L1.^2+59976.*d.^4.*k.^6.*L1.^2+5588352.*k.^4.*L1.^4+42336.* ...
        d.^2.*k.^6.*L1.^4).*L2.^5+(13/36960).*k.^6.*(585446400+(-23086800) ...
        .*d.^2.*k.^2+406252.*d.^4.*k.^4+5901.*d.^6.*k.^6+(-170755200).* ...
        k.^2.*L1.^2+6019552.*d.^2.*k.^4.*L1.^2+59976.*d.^4.*k.^6.*L1.^2+ ...
        9313920.*k.^4.*L1.^4+70560.*d.^2.*k.^6.*L1.^4).*L2.^6+(-13/330).* ...
        k.^8.*L1.*((-435600)+15356.*d.^2.*k.^2+153.*d.^4.*k.^4+47520.* ...
        k.^2.*L1.^2+360.*d.^2.*k.^4.*L1.^2).*L2.^7+(13/2640).*k.^8.*(( ...
        -435600)+15356.*d.^2.*k.^2+153.*d.^4.*k.^4+142560.*k.^2.*L1.^2+ ...
        1080.*d.^2.*k.^4.*L1.^2).*L2.^8+(-13/11).*k.^10.*(132+d.^2.*k.^2) ...
        .*L1.*L2.^9+(13/110).*k.^10.*(132+d.^2.*k.^2).*L2.^10).*pi.^(-1)+( ...
        1/8).*k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1).*pi.^(-1).*atan( ...
        d.*L1.^(-1))+(-1/8).*k.^2.*(d.^2.*k+sqrt(-1).*d.*k.*L1).*pi.^(-1) ...
        .*atan(d.*L1.^(-1))+(sqrt(-1)*(1/4)).*d.*k.^3.*L2.*pi.^(-1).*atan( ...
        d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*(1/4)).*d.*k.^3.*L2.*pi.^(-1).* ...
        atan(d.^(-1).*L2)+(1/8).*k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1) ...
        .*pi.^(-1).*atan(d.*((-1).*L1+L2).^(-1))+(-1/8).*k.^2.*(d.^2.*k+ ...
        sqrt(-1).*d.*k.*L1).*pi.^(-1).*atan(d.*((-1).*L1+L2).^(-1))+(sqrt( ...
        -1)*(1/8)).*d.^2.*k.^3.*pi.^(-1).*log(d.^2)+(sqrt(-1)*(-1/16)).* ...
        k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1).*pi.^(-1).*log(d.^2+ ...
        L1.^2)+(sqrt(-1)*(-1/16)).*k.^2.*(d.^2.*k+sqrt(-1).*d.*k.*L1).* ...
        pi.^(-1).*log(d.^2+L1.^2)+(1/163499212800).*k.^2.*((-40874803200)+ ...
        (-10218700800).*d.^2.*k.^2+212889600.*d.^4.*k.^4+(-3548160).* ...
        d.^6.*k.^6+39600.*d.^8.*k.^8+(-308).*d.^10.*k.^10+21.*d.^12.* ...
        k.^12).*L1.*pi.^(-1).*log((-1).*L1+(d.^2+L1.^2).^(1/2))+(sqrt(-1)* ...
        (-1/8)).*d.^2.*k.^3.*pi.^(-1).*log(d.^2+L2.^2)+(sqrt(-1)*(1/16)).* ...
        k.^2.*(d.^2.*k+(sqrt(-1)*(-1)).*d.*k.*L1).*pi.^(-1).*log(d.^2+ ...
        L1.^2+(-2).*L1.*L2+L2.^2)+(sqrt(-1)*(1/16)).*k.^2.*(d.^2.*k+sqrt( ...
        -1).*d.*k.*L1).*pi.^(-1).*log(d.^2+L1.^2+(-2).*L1.*L2+L2.^2)+( ...
        1/163499212800).*k.^2.*((-40874803200)+(-10218700800).*d.^2.*k.^2+ ...
        212889600.*d.^4.*k.^4+(-3548160).*d.^6.*k.^6+39600.*d.^8.*k.^8+( ...
        -308).*d.^10.*k.^10+21.*d.^12.*k.^12).*L2.*pi.^(-1).*log((-1).*L2+ ...
        (d.^2+L2.^2).^(1/2))+(-1/163499212800).*k.^2.*((-40874803200)+( ...
        -10218700800).*d.^2.*k.^2+212889600.*d.^4.*k.^4+(-3548160).*d.^6.* ...
        k.^6+39600.*d.^8.*k.^8+(-308).*d.^10.*k.^10+21.*d.^12.*k.^12).* ...
        L2.*pi.^(-1).*log(L1+(-1).*L2+(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^( ...
        1/2))+(-1/163499212800).*k.^2.*((-40874803200)+(-10218700800).* ...
        d.^2.*k.^2+212889600.*d.^4.*k.^4+(-3548160).*d.^6.*k.^6+39600.* ...
        d.^8.*k.^8+(-308).*d.^10.*k.^10+21.*d.^12.*k.^12).*L1.*pi.^(-1).* ...
        log((-1).*L1+L2+(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(1/2));
elseif order ==7
    H3_7O=(-1/117050572800).*k.^2.*pi.^(-1).*((d.^2).^(1/2).*((-58525286400) ...
        +(-9754214400).*d.^2.*k.^2+162570240.*d.^4.*k.^4+(-2322432).* ...
        d.^6.*k.^6+23040.*d.^8.*k.^8+(-896).*d.^10.*k.^10)+(-1).*(d.^2+ ...
        L1.^2).^(1/2).*((-896).*d.^10.*k.^10+5.*d.^8.*k.^8.*(4608+455.* ...
        k.^2.*L1.^2)+6.*d.^6.*k.^6.*((-387072)+2805.*k.^2.*L1.^2+245.* ...
        k.^4.*L1.^4)+4.*d.^4.*k.^4.*(40642560+(-344736).*k.^2.*L1.^2+ ...
        12555.*k.^4.*L1.^4+154.*k.^6.*L1.^6)+10080.*((-5806080)+(-241920) ...
        .*k.^2.*L1.^2+6048.*k.^4.*L1.^4+(-96).*k.^6.*L1.^6+k.^8.*L1.^8)+ ...
        16.*d.^2.*k.^2.*((-609638400)+4445280.*k.^2.*L1.^2+(-160272).* ...
        k.^4.*L1.^4+2385.*k.^6.*L1.^6+7.*k.^8.*L1.^8))+(-14631321600).*d.* ...
        k.*(d+(sqrt(-1)*(-1)).*L1).*atan(d.*L1.^(-1))+14631321600.*d.*k.*( ...
        d+sqrt(-1).*L1).*atan(d.*L1.^(-1))+(sqrt(-1)*(-14631321600)).* ...
        d.^2.*k.*log(d.^2)+(sqrt(-1)*7315660800).*d.*k.*(d+sqrt(-1).*L1).* ...
        log(d.^2+L1.^2)+7315660800.*d.*k.*(sqrt(-1).*d+L1).*log(d.^2+ ...
        L1.^2)+315.*(92897280+23224320.*d.^2.*k.^2+(-483840).*d.^4.*k.^4+ ...
        8064.*d.^6.*k.^6+(-90).*d.^8.*k.^8+7.*d.^10.*k.^10).*L1.*log((-1) ...
        .*L1+(d.^2+L1.^2).^(1/2)))+(1/117050572800).*k.^2.*pi.^(-1).*(( ...
        896.*d.^10.*k.^10+(-5).*d.^8.*k.^8.*(4608+455.*k.^2.*(L1+(-1).*L2) ...
        .^2)+(-6).*d.^6.*k.^6.*((-387072)+2805.*k.^2.*(L1+(-1).*L2).^2+ ...
        245.*k.^4.*(L1+(-1).*L2).^4)+(-4).*d.^4.*k.^4.*(40642560+(-344736) ...
        .*k.^2.*(L1+(-1).*L2).^2+12555.*k.^4.*(L1+(-1).*L2).^4+154.*k.^6.* ...
        (L1+(-1).*L2).^6)+(-10080).*((-5806080)+(-241920).*k.^2.*(L1+(-1) ...
        .*L2).^2+6048.*k.^4.*(L1+(-1).*L2).^4+(-96).*k.^6.*(L1+(-1).*L2) ...
        .^6+k.^8.*(L1+(-1).*L2).^8)+(-16).*d.^2.*k.^2.*((-609638400)+ ...
        4445280.*k.^2.*(L1+(-1).*L2).^2+(-160272).*k.^4.*(L1+(-1).*L2).^4+ ...
        2385.*k.^6.*(L1+(-1).*L2).^6+7.*k.^8.*(L1+(-1).*L2).^8)).*(d.^2+( ...
        L1+(-1).*L2).^2).^(1/2)+(sqrt(-1)*2304).*k.*L1.*(35.*d.^8.*k.^8+ ...
        35.*d.^6.*k.^8.*L1.^2+21.*d.^4.*k.^6.*L1.^2.*(40+k.^2.*L1.^2)+ ...
        d.^2.*k.^4.*L1.^2.*((-35280)+1008.*k.^2.*L1.^2+5.*k.^4.*L1.^4)+ ...
        72.*((-176400)+9800.*k.^2.*L1.^2+(-294).*k.^4.*L1.^4+5.*k.^6.* ...
        L1.^6)).*L2+(sqrt(-1)*40320).*k.*((-362880)+d.^8.*k.^8).*L2.^2+( ...
        sqrt(-1)*(-40320)).*k.*(d.^8.*k.^8+3.*d.^6.*k.^8.*L1.^2+3.*d.^4.* ...
        k.^6.*L1.^2.*(24+k.^2.*L1.^2)+d.^2.*k.^4.*L1.^2.*((-3024)+144.* ...
        k.^2.*L1.^2+k.^4.*L1.^4)+72.*((-5040)+840.*k.^2.*L1.^2+(-42).* ...
        k.^4.*L1.^4+k.^6.*L1.^6)).*L2.^2+(sqrt(-1)*80640).*k.^3.*L1.*( ...
        d.^6.*k.^6+2.*d.^4.*k.^4.*(12+k.^2.*L1.^2)+72.*(280+(-28).*k.^2.* ...
        L1.^2+k.^4.*L1.^4)+d.^2.*k.^2.*((-1008)+96.*k.^2.*L1.^2+k.^4.* ...
        L1.^4)).*L2.^3+(sqrt(-1)*20160).*k.^3.*(20160+(-1008).*d.^2.*k.^2+ ...
        24.*d.^4.*k.^4+d.^6.*k.^6).*L2.^4+(sqrt(-1)*(-20160)).*k.^3.*( ...
        d.^6.*k.^6+6.*d.^4.*k.^4.*(4+k.^2.*L1.^2)+72.*(280+(-84).*k.^2.* ...
        L1.^2+5.*k.^4.*L1.^4)+d.^2.*k.^2.*((-1008)+288.*k.^2.*L1.^2+5.* ...
        k.^4.*L1.^4)).*L2.^4+(sqrt(-1)*16128).*k.^5.*L1.*(3.*d.^4.*k.^4+ ...
        72.*((-42)+5.*k.^2.*L1.^2)+d.^2.*k.^2.*(144+5.*k.^2.*L1.^2)).* ...
        L2.^5+(sqrt(-1)*8064).*k.^5.*((-1008)+48.*d.^2.*k.^2+d.^4.*k.^4).* ...
        L2.^6+(sqrt(-1)*(-8064)).*k.^5.*(d.^4.*k.^4+72.*((-14)+5.*k.^2.* ...
        L1.^2)+d.^2.*k.^2.*(48+5.*k.^2.*L1.^2)).*L2.^6+(sqrt(-1)*11520).* ...
        k.^7.*(72+d.^2.*k.^2).*L1.*L2.^7+(d.^2+L2.^2).^(1/2).*((-896).* ...
        d.^10.*k.^10+5.*d.^8.*k.^8.*(4608+455.*k.^2.*L2.^2)+6.*d.^6.* ...
        k.^6.*((-387072)+2805.*k.^2.*L2.^2+245.*k.^4.*L2.^4)+4.*d.^4.* ...
        k.^4.*(40642560+(-344736).*k.^2.*L2.^2+12555.*k.^4.*L2.^4+154.* ...
        k.^6.*L2.^6)+10080.*((-5806080)+(-241920).*k.^2.*L2.^2+6048.* ...
        k.^4.*L2.^4+(-96).*k.^6.*L2.^6+k.^8.*L2.^8)+16.*d.^2.*k.^2.*(( ...
        -609638400)+4445280.*k.^2.*L2.^2+(-160272).*k.^4.*L2.^4+2385.* ...
        k.^6.*L2.^6+7.*k.^8.*L2.^8))+14631321600.*d.*k.*(d+sqrt(-1).*L1).* ...
        atan(d.*(L1+(-1).*L2).^(-1))+(sqrt(-1)*29262643200).*d.*k.*L2.* ...
        atan(d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*29262643200).*d.*k.*L2.* ...
        atan(d.^(-1).*L2)+14631321600.*d.*k.*(d+(sqrt(-1)*(-1)).*L1).* ...
        atan(d.*((-1).*L1+L2).^(-1))+(sqrt(-1)*7315660800).*d.*k.*(d+sqrt( ...
        -1).*L1).*log(d.^2+(L1+(-1).*L2).^2)+7315660800.*d.*k.*(sqrt(-1).* ...
        d+L1).*log(d.^2+(L1+(-1).*L2).^2)+315.*(92897280+23224320.*d.^2.* ...
        k.^2+(-483840).*d.^4.*k.^4+8064.*d.^6.*k.^6+(-90).*d.^8.*k.^8+7.* ...
        d.^10.*k.^10).*L2.*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2) ...
        +315.*(92897280+23224320.*d.^2.*k.^2+(-483840).*d.^4.*k.^4+8064.* ...
        d.^6.*k.^6+(-90).*d.^8.*k.^8+7.*d.^10.*k.^10).*L1.*log((-1).*L1+( ...
        d.^2+(L1+(-1).*L2).^2).^(1/2)+L2)+(sqrt(-1)*(-14631321600)).* ...
        d.^2.*k.*log(d.^2+L2.^2)+(-315).*(92897280+23224320.*d.^2.*k.^2+( ...
        -483840).*d.^4.*k.^4+8064.*d.^6.*k.^6+(-90).*d.^8.*k.^8+7.*d.^10.* ...
        k.^10).*L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2)));
    H3_total = H3_7O;
elseif order == 8
    H3_8O=(-1/6437781504000).*k.^2.*pi.^(-1).*(55.*(d.^2).^(1/2).*(( ...
        -58525286400)+(-9754214400).*d.^2.*k.^2+162570240.*d.^4.*k.^4+( ...
        -2322432).*d.^6.*k.^6+23040.*d.^8.*k.^8+(-896).*d.^10.*k.^10)+( ...
        -55).*(d.^2+L1.^2).^(1/2).*((-896).*d.^10.*k.^10+5.*d.^8.*k.^8.*( ...
        4608+455.*k.^2.*L1.^2)+6.*d.^6.*k.^6.*((-387072)+2805.*k.^2.* ...
        L1.^2+245.*k.^4.*L1.^4)+4.*d.^4.*k.^4.*(40642560+(-344736).*k.^2.* ...
        L1.^2+12555.*k.^4.*L1.^4+154.*k.^6.*L1.^6)+10080.*((-5806080)+( ...
        -241920).*k.^2.*L1.^2+6048.*k.^4.*L1.^4+(-96).*k.^6.*L1.^6+k.^8.* ...
        L1.^8)+16.*d.^2.*k.^2.*((-609638400)+4445280.*k.^2.*L1.^2+( ...
        -160272).*k.^4.*L1.^4+2385.*k.^6.*L1.^6+7.*k.^8.*L1.^8))+( ...
        -804722688000).*d.*k.*(d+(sqrt(-1)*(-1)).*L1).*atan(d.*L1.^(-1))+ ...
        804722688000.*d.*k.*(d+sqrt(-1).*L1).*atan(d.*L1.^(-1))+(sqrt(-1)* ...
        (-804722688000)).*d.^2.*k.*log(d.^2)+(sqrt(-1)*402361344000).*d.* ...
        k.*(d+sqrt(-1).*L1).*log(d.^2+L1.^2)+402361344000.*d.*k.*(sqrt(-1) ...
        .*d+L1).*log(d.^2+L1.^2)+17325.*(92897280+23224320.*d.^2.*k.^2+( ...
        -483840).*d.^4.*k.^4+8064.*d.^6.*k.^6+(-90).*d.^8.*k.^8+7.*d.^10.* ...
        k.^10).*L1.*log((-1).*L1+(d.^2+L1.^2).^(1/2)))+(1/6437781504000).* ...
        k.^2.*pi.^(-1).*((-55).*((-896).*d.^10.*k.^10+5.*d.^8.*k.^8.*( ...
        4608+455.*k.^2.*(L1+(-1).*L2).^2)+6.*d.^6.*k.^6.*((-387072)+2805.* ...
        k.^2.*(L1+(-1).*L2).^2+245.*k.^4.*(L1+(-1).*L2).^4)+4.*d.^4.* ...
        k.^4.*(40642560+(-344736).*k.^2.*(L1+(-1).*L2).^2+12555.*k.^4.*( ...
        L1+(-1).*L2).^4+154.*k.^6.*(L1+(-1).*L2).^6)+10080.*((-5806080)+( ...
        -241920).*k.^2.*(L1+(-1).*L2).^2+6048.*k.^4.*(L1+(-1).*L2).^4+( ...
        -96).*k.^6.*(L1+(-1).*L2).^6+k.^8.*(L1+(-1).*L2).^8)+16.*d.^2.* ...
        k.^2.*((-609638400)+4445280.*k.^2.*(L1+(-1).*L2).^2+(-160272).* ...
        k.^4.*(L1+(-1).*L2).^4+2385.*k.^6.*(L1+(-1).*L2).^6+7.*k.^8.*(L1+( ...
        -1).*L2).^8)).*(d.^2+(L1+(-1).*L2).^2).^(1/2)+(sqrt(-1)*(-128)).* ...
        k.*L1.*(315.*d.^10.*k.^10+420.*d.^8.*k.^10.*L1.^2+42.*d.^6.*k.^8.* ...
        L1.^2.*(275+9.*k.^2.*L1.^2)+90.*d.^4.*k.^6.*L1.^2.*((-9240)+231.* ...
        k.^2.*L1.^2+2.*k.^4.*L1.^4)+5.*d.^2.*k.^4.*L1.^2.*(6985440+( ...
        -199584).*k.^2.*L1.^2+2970.*k.^4.*L1.^4+7.*k.^6.*L1.^6)+110.*( ...
        114307200+(-6350400).*k.^2.*L1.^2+190512.*k.^4.*L1.^4+(-3240).* ...
        k.^6.*L1.^6+35.*k.^8.*L1.^8)).*L2+(sqrt(-1)*20160).*k.^3.*L1.^2.*( ...
        4.*d.^8.*k.^8+2.*d.^6.*k.^6.*(55+3.*k.^2.*L1.^2)+d.^4.*((-7920).* ...
        k.^4+330.*k.^6.*L1.^2+4.*k.^8.*L1.^4)+110.*((-60480)+3024.*k.^2.* ...
        L1.^2+(-72).*k.^4.*L1.^4+k.^6.*L1.^6)+d.^2.*k.^2.*(332640+(-15840) ...
        .*k.^2.*L1.^2+330.*k.^4.*L1.^4+k.^6.*L1.^6)).*L2.^2+(sqrt(-1)*( ...
        -26880)).*k.^3.*L1.*(2.*d.^8.*k.^8+d.^6.*k.^6.*(55+6.*k.^2.*L1.^2) ...
        +6.*d.^4.*k.^4.*((-660)+55.*k.^2.*L1.^2+k.^4.*L1.^4)+220.*(( ...
        -15120)+1512.*k.^2.*L1.^2+(-54).*k.^4.*L1.^4+k.^6.*L1.^6)+d.^2.* ...
        k.^2.*(166320+(-15840).*k.^2.*L1.^2+495.*k.^4.*L1.^4+2.*k.^6.* ...
        L1.^6)).*L2.^3+(sqrt(-1)*6720).*k.^5.*L1.^2.*(18.*d.^6.*k.^6+30.* ...
        d.^4.*k.^4.*(33+k.^2.*L1.^2)+220.*(4536+(-270).*k.^2.*L1.^2+7.* ...
        k.^4.*L1.^4)+d.^2.*k.^2.*((-47520)+2475.*k.^2.*L1.^2+14.*k.^4.* ...
        L1.^4)).*L2.^4+(sqrt(-1)*(-16128)).*k.^5.*L1.*(3.*d.^6.*k.^6+5.* ...
        d.^4.*k.^4.*(33+2.*k.^2.*L1.^2)+110.*(1512+(-180).*k.^2.*L1.^2+7.* ...
        k.^4.*L1.^4)+d.^2.*k.^2.*((-7920)+825.*k.^2.*L1.^2+7.*k.^4.*L1.^4) ...
        ).*L2.^5+(sqrt(-1)*13440).*k.^7.*L1.^2.*(6.*d.^4.*k.^4+110.*(( ...
        -108)+7.*k.^2.*L1.^2)+d.^2.*k.^2.*(495+7.*k.^2.*L1.^2)).*L2.^6+( ...
        sqrt(-1)*(-3840)).*k.^7.*L1.*(6.*d.^4.*k.^4+220.*((-54)+7.*k.^2.* ...
        L1.^2)+d.^2.*k.^2.*(495+14.*k.^2.*L1.^2)).*L2.^7+(sqrt(-1)*20160) ...
        .*k.^9.*(110+d.^2.*k.^2).*L1.^2.*L2.^8+(sqrt(-1)*(-4480)).*k.^9.*( ...
        110+d.^2.*k.^2).*L1.*L2.^9+55.*(d.^2+L2.^2).^(1/2).*((-896).* ...
        d.^10.*k.^10+5.*d.^8.*k.^8.*(4608+455.*k.^2.*L2.^2)+6.*d.^6.* ...
        k.^6.*((-387072)+2805.*k.^2.*L2.^2+245.*k.^4.*L2.^4)+4.*d.^4.* ...
        k.^4.*(40642560+(-344736).*k.^2.*L2.^2+12555.*k.^4.*L2.^4+154.* ...
        k.^6.*L2.^6)+10080.*((-5806080)+(-241920).*k.^2.*L2.^2+6048.* ...
        k.^4.*L2.^4+(-96).*k.^6.*L2.^6+k.^8.*L2.^8)+16.*d.^2.*k.^2.*(( ...
        -609638400)+4445280.*k.^2.*L2.^2+(-160272).*k.^4.*L2.^4+2385.* ...
        k.^6.*L2.^6+7.*k.^8.*L2.^8))+804722688000.*d.*k.*(d+sqrt(-1).*L1) ...
        .*atan(d.*(L1+(-1).*L2).^(-1))+(sqrt(-1)*1609445376000).*d.*k.* ...
        L2.*atan(d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*1609445376000).*d.*k.* ...
        L2.*atan(d.^(-1).*L2)+804722688000.*d.*k.*(d+(sqrt(-1)*(-1)).*L1) ...
        .*atan(d.*((-1).*L1+L2).^(-1))+(sqrt(-1)*402361344000).*d.*k.*(d+ ...
        sqrt(-1).*L1).*log(d.^2+(L1+(-1).*L2).^2)+402361344000.*d.*k.*( ...
        sqrt(-1).*d+L1).*log(d.^2+(L1+(-1).*L2).^2)+17325.*(92897280+ ...
        23224320.*d.^2.*k.^2+(-483840).*d.^4.*k.^4+8064.*d.^6.*k.^6+(-90) ...
        .*d.^8.*k.^8+7.*d.^10.*k.^10).*L2.*log(L1+(d.^2+(L1+(-1).*L2).^2) ...
        .^(1/2)+(-1).*L2)+17325.*(92897280+23224320.*d.^2.*k.^2+(-483840) ...
        .*d.^4.*k.^4+8064.*d.^6.*k.^6+(-90).*d.^8.*k.^8+7.*d.^10.*k.^10).* ...
        L1.*log((-1).*L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+L2)+(sqrt(-1)*( ...
        -804722688000)).*d.^2.*k.*log(d.^2+L2.^2)+(-17325).*(92897280+ ...
        23224320.*d.^2.*k.^2+(-483840).*d.^4.*k.^4+8064.*d.^6.*k.^6+(-90) ...
        .*d.^8.*k.^8+7.*d.^10.*k.^10).*L2.*log((-1).*L2+(d.^2+L2.^2).^( ...
        1/2)));
    H3_total = H3_8O;
elseif order == 11
    H3_11O=(-1/2297824476659712000).*k.^2.*pi.^(-1).*(3.*(d.^2).^(1/2).*(( ...
        -382970746109952000)+(-63828457684992000).*d.^2.*k.^2+ ...
        1063807628083200.*d.^4.*k.^4+(-15197251829760).*d.^6.*k.^6+ ...
        150766387200.*d.^8.*k.^8+(-1066024960).*d.^10.*k.^10+5591040.* ...
        d.^12.*k.^12+(-168960).*d.^14.*k.^14)+(-3).*(d.^2+L1.^2).^(1/2).*( ...
        (-168960).*d.^14.*k.^14+105.*d.^12.*k.^12.*(53248+6545.*k.^2.* ...
        L1.^2)+70.*d.^10.*k.^10.*((-15228928)+77181.*k.^2.*L1.^2+10351.* ...
        k.^4.*L1.^4)+4.*d.^8.*k.^8.*(37691596800+(-227467240).*k.^2.* ...
        L1.^2+7486115.*k.^4.*L1.^4+150766.*k.^6.*L1.^6)+16.*d.^6.*k.^6.*(( ...
        -949828239360)+6883133400.*k.^2.*L1.^2+(-239699460).*k.^4.*L1.^4+ ...
        2870777.*k.^6.*L1.^6+20493.*k.^8.*L1.^8)+32.*d.^4.*k.^4.*( ...
        33243988377600+(-281980258560).*k.^2.*L1.^2+10269487800.*k.^4.* ...
        L1.^4+(-137313176).*k.^6.*L1.^6+1140867.*k.^8.*L1.^8+3212.*k.^10.* ...
        L1.^10)+512512.*((-747242496000)+(-31135104000).*k.^2.*L1.^2+ ...
        778377600.*k.^4.*L1.^4+(-12355200).*k.^6.*L1.^6+128700.*k.^8.* ...
        L1.^8+(-936).*k.^10.*L1.^10+5.*k.^12.*L1.^12)+256.*d.^2.*k.^2.*(( ...
        -249329912832000)+1818030614400.*k.^2.*L1.^2+(-65548042560).* ...
        k.^4.*L1.^4+975417300.*k.^6.*L1.^6+(-9083074).*k.^8.*L1.^8+58877.* ...
        k.^10.*L1.^10+55.*k.^12.*L1.^12))+(-287228059582464000).*d.*k.*(d+ ...
        (sqrt(-1)*(-1)).*L1).*atan(d.*L1.^(-1))+287228059582464000.*d.*k.* ...
        (d+sqrt(-1).*L1).*atan(d.*L1.^(-1))+(sqrt(-1)*( ...
        -287228059582464000)).*d.^2.*k.*log(d.^2)+(sqrt(-1)* ...
        143614029791232000).*d.*k.*(d+sqrt(-1).*L1).*log(d.^2+L1.^2)+ ...
        143614029791232000.*d.*k.*(sqrt(-1).*d+L1).*log(d.^2+L1.^2)+ ...
        135135.*(4250979532800+1062744883200.*d.^2.*k.^2+(-22140518400).* ...
        d.^4.*k.^4+369008640.*d.^6.*k.^6+(-4118400).*d.^8.*k.^8+32032.* ...
        d.^10.*k.^10+(-182).*d.^12.*k.^12+11.*d.^14.*k.^14).*L1.*log((-1) ...
        .*L1+(d.^2+L1.^2).^(1/2)))+(1/2297824476659712000).*k.^2.*pi.^(-1) ...
        .*((-3).*((-168960).*d.^14.*k.^14+105.*d.^12.*k.^12.*(53248+6545.* ...
        k.^2.*(L1+(-1).*L2).^2)+70.*d.^10.*k.^10.*((-15228928)+77181.* ...
        k.^2.*(L1+(-1).*L2).^2+10351.*k.^4.*(L1+(-1).*L2).^4)+4.*d.^8.* ...
        k.^8.*(37691596800+(-227467240).*k.^2.*(L1+(-1).*L2).^2+7486115.* ...
        k.^4.*(L1+(-1).*L2).^4+150766.*k.^6.*(L1+(-1).*L2).^6)+16.*d.^6.* ...
        k.^6.*((-949828239360)+6883133400.*k.^2.*(L1+(-1).*L2).^2+( ...
        -239699460).*k.^4.*(L1+(-1).*L2).^4+2870777.*k.^6.*(L1+(-1).*L2) ...
        .^6+20493.*k.^8.*(L1+(-1).*L2).^8)+32.*d.^4.*k.^4.*( ...
        33243988377600+(-281980258560).*k.^2.*(L1+(-1).*L2).^2+ ...
        10269487800.*k.^4.*(L1+(-1).*L2).^4+(-137313176).*k.^6.*(L1+(-1).* ...
        L2).^6+1140867.*k.^8.*(L1+(-1).*L2).^8+3212.*k.^10.*(L1+(-1).*L2) ...
        .^10)+512512.*((-747242496000)+(-31135104000).*k.^2.*(L1+(-1).*L2) ...
        .^2+778377600.*k.^4.*(L1+(-1).*L2).^4+(-12355200).*k.^6.*(L1+(-1) ...
        .*L2).^6+128700.*k.^8.*(L1+(-1).*L2).^8+(-936).*k.^10.*(L1+(-1).* ...
        L2).^10+5.*k.^12.*(L1+(-1).*L2).^12)+256.*d.^2.*k.^2.*(( ...
        -249329912832000)+1818030614400.*k.^2.*(L1+(-1).*L2).^2+( ...
        -65548042560).*k.^4.*(L1+(-1).*L2).^4+975417300.*k.^6.*(L1+(-1).* ...
        L2).^6+(-9083074).*k.^8.*(L1+(-1).*L2).^8+58877.*k.^10.*(L1+(-1).* ...
        L2).^10+55.*k.^12.*(L1+(-1).*L2).^12)).*(d.^2+(L1+(-1).*L2).^2).^( ...
        1/2)+(sqrt(-1)*26624).*k.*L1.*(3465.*d.^12.*k.^12+5775.*d.^10.* ...
        k.^12.*L1.^2+6930.*d.^8.*k.^10.*L1.^2.*(26+k.^2.*L1.^2)+198.* ...
        d.^6.*k.^8.*L1.^2.*((-100100)+2184.*k.^2.*L1.^2+25.*k.^4.*L1.^4)+ ...
        55.*d.^4.*k.^6.*L1.^2.*(25945920+(-648648).*k.^2.*L1.^2+8424.* ...
        k.^4.*L1.^4+35.*k.^6.*L1.^6)+15.*d.^2.*k.^4.*L1.^2.*((-3995671680) ...
        +114162048.*k.^2.*L1.^2+(-1698840).*k.^4.*L1.^4+16016.*k.^6.* ...
        L1.^6+21.*k.^8.*L1.^8)+780.*((-27662342400)+1536796800.*k.^2.* ...
        L1.^2+(-46103904).*k.^4.*L1.^4+784080.*k.^6.*L1.^6+(-8470).*k.^8.* ...
        L1.^8+63.*k.^10.*L1.^10)).*L2+(sqrt(-1)*(-46126080)).*k.^3.* ...
        L1.^2.*(5.*d.^10.*k.^10+2.*d.^8.*k.^8.*(78+5.*k.^2.*L1.^2)+2.* ...
        d.^6.*k.^6.*((-8580)+312.*k.^2.*L1.^2+5.*k.^4.*L1.^4)+d.^4.*k.^4.* ...
        (1235520+(-51480).*k.^2.*L1.^2+936.*k.^4.*L1.^4+5.*k.^6.*L1.^6)+ ...
        156.*(6652800+(-332640).*k.^2.*L1.^2+7920.*k.^4.*L1.^4+(-110).* ...
        k.^6.*L1.^6+k.^8.*L1.^8)+d.^2.*k.^2.*((-51891840)+2471040.*k.^2.* ...
        L1.^2+(-51480).*k.^4.*L1.^4+624.*k.^6.*L1.^6+k.^8.*L1.^8)).*L2.^2+ ...
        (sqrt(-1)*30750720).*k.^3.*L1.*(5.*d.^10.*k.^10+4.*d.^8.*k.^8.*( ...
        39+5.*k.^2.*L1.^2)+6.*d.^6.*k.^6.*((-2860)+208.*k.^2.*L1.^2+5.* ...
        k.^4.*L1.^4)+4.*d.^4.*k.^4.*(308880+(-25740).*k.^2.*L1.^2+702.* ...
        k.^4.*L1.^4+5.*k.^6.*L1.^6)+780.*(1330560+(-133056).*k.^2.*L1.^2+ ...
        4752.*k.^4.*L1.^4+(-88).*k.^6.*L1.^6+k.^8.*L1.^8)+d.^2.*k.^2.*(( ...
        -51891840)+4942080.*k.^2.*L1.^2+(-154440).*k.^4.*L1.^4+2496.* ...
        k.^6.*L1.^6+5.*k.^8.*L1.^8)).*L2.^3+(sqrt(-1)*(-7687680)).*k.^5.* ...
        L1.^2.*(60.*d.^8.*k.^8+6.*d.^6.*k.^6.*(624+25.*k.^2.*L1.^2)+20.* ...
        d.^4.*k.^4.*((-15444)+702.*k.^2.*L1.^2+7.*k.^4.*L1.^4)+780.*(( ...
        -399168)+23760.*k.^2.*L1.^2+(-616).*k.^4.*L1.^4+9.*k.^6.*L1.^6)+ ...
        3.*d.^2.*k.^2.*(4942080+(-257400).*k.^2.*L1.^2+5824.*k.^4.*L1.^4+ ...
        15.*k.^6.*L1.^6)).*L2.^4+(sqrt(-1)*36900864).*k.^5.*L1.*(5.*d.^8.* ...
        k.^8+d.^6.*k.^6.*(312+25.*k.^2.*L1.^2)+5.*d.^4.*k.^4.*((-5148)+ ...
        468.*k.^2.*L1.^2+7.*k.^4.*L1.^4)+780.*((-33264)+3960.*k.^2.*L1.^2+ ...
        (-154).*k.^4.*L1.^4+3.*k.^6.*L1.^6)+3.*d.^2.*k.^2.*(411840+( ...
        -42900).*k.^2.*L1.^2+1456.*k.^4.*L1.^4+5.*k.^6.*L1.^6)).*L2.^5+( ...
        sqrt(-1)*(-30750720)).*k.^7.*L1.^2.*(15.*d.^6.*k.^6+d.^4.*k.^4.*( ...
        1404+35.*k.^2.*L1.^2)+3.*d.^2.*k.^2.*((-25740)+1456.*k.^2.*L1.^2+ ...
        7.*k.^4.*L1.^4)+156.*(11880+(-770).*k.^2.*L1.^2+21.*k.^4.*L1.^4)) ...
        .*L2.^6+(sqrt(-1)*8785920).*k.^7.*L1.*(15.*d.^6.*k.^6+2.*d.^4.* ...
        k.^4.*(702+35.*k.^2.*L1.^2)+156.*(11880+(-1540).*k.^2.*L1.^2+63.* ...
        k.^4.*L1.^4)+d.^2.*((-77220).*k.^2+8736.*k.^4.*L1.^2+63.*k.^6.* ...
        L1.^4)).*L2.^7+(sqrt(-1)*(-23063040)).*k.^9.*L1.^2.*(10.*d.^4.* ...
        k.^4+780.*((-44)+3.*k.^2.*L1.^2)+3.*d.^2.*k.^2.*(416+5.*k.^2.* ...
        L1.^2)).*L2.^8+(sqrt(-1)*10250240).*k.^9.*L1.*(5.*d.^4.*k.^4+780.* ...
        ((-22)+3.*k.^2.*L1.^2)+3.*d.^2.*k.^2.*(208+5.*k.^2.*L1.^2)).* ...
        L2.^9+(sqrt(-1)*(-46126080)).*k.^11.*(156+d.^2.*k.^2).*L1.^2.* ...
        L2.^10+(sqrt(-1)*8386560).*k.^11.*(156+d.^2.*k.^2).*L1.*L2.^11+3.* ...
        (d.^2+L2.^2).^(1/2).*((-168960).*d.^14.*k.^14+105.*d.^12.*k.^12.*( ...
        53248+6545.*k.^2.*L2.^2)+70.*d.^10.*k.^10.*((-15228928)+77181.* ...
        k.^2.*L2.^2+10351.*k.^4.*L2.^4)+4.*d.^8.*k.^8.*(37691596800+( ...
        -227467240).*k.^2.*L2.^2+7486115.*k.^4.*L2.^4+150766.*k.^6.*L2.^6) ...
        +16.*d.^6.*k.^6.*((-949828239360)+6883133400.*k.^2.*L2.^2+( ...
        -239699460).*k.^4.*L2.^4+2870777.*k.^6.*L2.^6+20493.*k.^8.*L2.^8)+ ...
        32.*d.^4.*k.^4.*(33243988377600+(-281980258560).*k.^2.*L2.^2+ ...
        10269487800.*k.^4.*L2.^4+(-137313176).*k.^6.*L2.^6+1140867.*k.^8.* ...
        L2.^8+3212.*k.^10.*L2.^10)+512512.*((-747242496000)+(-31135104000) ...
        .*k.^2.*L2.^2+778377600.*k.^4.*L2.^4+(-12355200).*k.^6.*L2.^6+ ...
        128700.*k.^8.*L2.^8+(-936).*k.^10.*L2.^10+5.*k.^12.*L2.^12)+256.* ...
        d.^2.*k.^2.*((-249329912832000)+1818030614400.*k.^2.*L2.^2+( ...
        -65548042560).*k.^4.*L2.^4+975417300.*k.^6.*L2.^6+(-9083074).* ...
        k.^8.*L2.^8+58877.*k.^10.*L2.^10+55.*k.^12.*L2.^12))+ ...
        287228059582464000.*d.*k.*(d+sqrt(-1).*L1).*atan(d.*(L1+(-1).*L2) ...
        .^(-1))+(sqrt(-1)*574456119164928000).*d.*k.*L2.*atan(d.^(-1).*( ...
        L1+(-1).*L2))+(sqrt(-1)*574456119164928000).*d.*k.*L2.*atan(d.^( ...
        -1).*L2)+287228059582464000.*d.*k.*(d+(sqrt(-1)*(-1)).*L1).*atan( ...
        d.*((-1).*L1+L2).^(-1))+(sqrt(-1)*143614029791232000).*d.*k.*(d+ ...
        sqrt(-1).*L1).*log(d.^2+(L1+(-1).*L2).^2)+143614029791232000.*d.* ...
        k.*(sqrt(-1).*d+L1).*log(d.^2+(L1+(-1).*L2).^2)+135135.*( ...
        4250979532800+1062744883200.*d.^2.*k.^2+(-22140518400).*d.^4.* ...
        k.^4+369008640.*d.^6.*k.^6+(-4118400).*d.^8.*k.^8+32032.*d.^10.* ...
        k.^10+(-182).*d.^12.*k.^12+11.*d.^14.*k.^14).*L2.*log(L1+(d.^2+( ...
        L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+135135.*(4250979532800+ ...
        1062744883200.*d.^2.*k.^2+(-22140518400).*d.^4.*k.^4+369008640.* ...
        d.^6.*k.^6+(-4118400).*d.^8.*k.^8+32032.*d.^10.*k.^10+(-182).* ...
        d.^12.*k.^12+11.*d.^14.*k.^14).*L1.*log((-1).*L1+(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2)+L2)+(sqrt(-1)*(-287228059582464000)).*d.^2.*k.*log( ...
        d.^2+L2.^2)+(-135135).*(4250979532800+1062744883200.*d.^2.*k.^2+( ...
        -22140518400).*d.^4.*k.^4+369008640.*d.^6.*k.^6+(-4118400).*d.^8.* ...
        k.^8+32032.*d.^10.*k.^10+(-182).*d.^12.*k.^12+11.*d.^14.*k.^14).* ...
        L2.*log((-1).*L2+(d.^2+L2.^2).^(1/2)));
    H3_total = H3_11O;
elseif order == 12

    H3_12O=(1/4).*(d.^2).^(1/2).*k.^2.*pi.^(-1)+(1/8).*(d.^2).^(1/2).*k.^2.*( ...
        2+d.^2.*k.^2).*pi.^(-1)+(-1/288).*(d.^2).^(3/2).*k.^4.*(12+d.^2.* ...
        k.^2).*pi.^(-1)+(1/7680).*d.^4.*(d.^2).^(1/2).*k.^6.*(30+d.^2.* ...
        k.^2).*pi.^(-1)+(-7/115200).*(d.^2).^(5/2).*k.^6.*(30+d.^2.*k.^2) ...
        .*pi.^(-1)+(-1/1128960).*d.^6.*(d.^2).^(1/2).*k.^8.*(56+d.^2.* ...
        k.^2).*pi.^(-1)+(1/130636800).*d.^8.*(d.^2).^(1/2).*k.^10.*(90+ ...
        d.^2.*k.^2).*pi.^(-1)+(-1/21076070400).*d.^10.*(d.^2).^(1/2).* ...
        k.^12.*(132+d.^2.*k.^2).*pi.^(-1)+(1/4533271142400).*d.^12.*(d.^2) ...
        .^(1/2).*k.^14.*(182+d.^2.*k.^2).*pi.^(-1)+(sqrt(-1)*(1/2903040)) ...
        .*d.^6.*k.^9.*(72+d.^2.*k.^2).*L1.^2.*pi.^(-1)+(sqrt(-1)*( ...
        -1/319334400)).*d.^8.*k.^11.*(110+d.^2.*k.^2).*L1.^2.*pi.^(-1)+( ...
        sqrt(-1)*(1/49816166400)).*d.^10.*k.^13.*(156+d.^2.*k.^2).*L1.^2.* ...
        pi.^(-1)+(sqrt(-1)*(-1/10461394944000)).*d.^12.*k.^15.*(210+d.^2.* ...
        k.^2).*L1.^2.*pi.^(-1)+(-1/4).*k.^2.*(d.^2+L1.^2).^(1/2).*pi.^(-1) ...
        +(-1/8).*k.^2.*(2+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).*pi.^(-1)+( ...
        1/192).*d.^2.*k.^4.*(12+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).*pi.^(-1) ...
        +(-1/7680).*d.^4.*k.^6.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).* ...
        pi.^(-1)+(1/516096).*d.^6.*k.^8.*(56+d.^2.*k.^2).*(d.^2+L1.^2).^( ...
        1/2).*pi.^(-1)+(-1/53084160).*d.^8.*k.^10.*(90+d.^2.*k.^2).*(d.^2+ ...
        L1.^2).^(1/2).*pi.^(-1)+(1/7785676800).*d.^10.*k.^12.*(132+d.^2.* ...
        k.^2).*(d.^2+L1.^2).^(1/2).*pi.^(-1)+(-1/1545810739200).*d.^12.* ...
        k.^14.*(182+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).*pi.^(-1)+(-1/576).* ...
        k.^4.*(12+d.^2.*k.^2).*(d.^2+L1.^2).^(3/2).*pi.^(-1)+(1/23040).* ...
        d.^2.*k.^6.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(3/2).*pi.^(-1)+( ...
        1/57600).*k.^6.*(30+d.^2.*k.^2).*(d.^2+L1.^2).^(5/2).*pi.^(-1)+( ...
        -1/15482880).*k.^8.*(56+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).*((114/7) ...
        .*d.^6+(174/7).*d.^4.*L1.^2+(76/7).*d.^2.*L1.^4+(16/7).*L1.^6).* ...
        pi.^(-1)+(1/11147673600).*k.^10.*(90+d.^2.*k.^2).*(d.^2+L1.^2).^( ...
        1/2).*((374/3).*d.^8+(650/3).*d.^6.*L1.^2+140.*d.^4.*L1.^4+(176/3) ...
        .*d.^2.*L1.^6+(32/3).*L1.^8).*pi.^(-1)+(-1/2452488192000).*k.^12.* ...
        (132+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2).*((2185/11).*d.^10+(4215/11) ...
        .*d.^8.*L1.^2+(3590/11).*d.^6.*L1.^4+(2248/11).*d.^4.*L1.^6+( ...
        816/11).*d.^2.*L1.^8+(128/11).*L1.^10).*pi.^(-1)+( ...
        1/5356234211328000).*k.^14.*(182+d.^2.*k.^2).*(d.^2+L1.^2).^(1/2) ...
        .*((29685/13).*d.^12+(62475/13).*d.^10.*L1.^2+(65870/13).*d.^8.* ...
        L1.^4+(54824/13).*d.^6.*L1.^6+(29808/13).*d.^4.*L1.^8+(9344/13).* ...
        d.^2.*L1.^10+(1280/13).*L1.^12).*pi.^(-1)+(1/8).*k.^2.*(2+d.^2.* ...
        k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*pi.^(-1)+(-1/192).*d.^2.* ...
        k.^4.*(12+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*pi.^(-1)+( ...
        1/7680).*d.^4.*k.^6.*(30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^( ...
        1/2).*pi.^(-1)+(-1/516096).*d.^6.*k.^8.*(56+d.^2.*k.^2).*(d.^2+( ...
        L1+(-1).*L2).^2).^(1/2).*pi.^(-1)+(1/53084160).*d.^8.*k.^10.*(90+ ...
        d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*pi.^(-1)+( ...
        -1/7785676800).*d.^10.*k.^12.*(132+d.^2.*k.^2).*(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2).*pi.^(-1)+(1/1545810739200).*d.^12.*k.^14.*(182+ ...
        d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^(1/2).*pi.^(-1)+(sqrt(-1)*( ...
        -1/24)).*k.^3.*(6+d.^2.*k.^2).*L1.*L2.*pi.^(-1)+(sqrt(-1)*(1/480)) ...
        .*d.^2.*k.^5.*(20+d.^2.*k.^2).*L1.*L2.*pi.^(-1)+(sqrt(-1)*( ...
        -1/20160)).*d.^4.*k.^7.*(42+d.^2.*k.^2).*L1.*L2.*pi.^(-1)+(sqrt( ...
        -1)*(1/1451520)).*d.^6.*k.^9.*(72+d.^2.*k.^2).*L1.*L2.*pi.^(-1)+( ...
        sqrt(-1)*(-1/159667200)).*d.^8.*k.^11.*(110+d.^2.*k.^2).*L1.*L2.* ...
        pi.^(-1)+(sqrt(-1)*(1/24908083200)).*d.^10.*k.^13.*(156+d.^2.* ...
        k.^2).*L1.*L2.*pi.^(-1)+(sqrt(-1)*(-1/5230697472000)).*d.^12.* ...
        k.^15.*(210+d.^2.*k.^2).*L1.*L2.*pi.^(-1)+(sqrt(-1)*(1/1440)).* ...
        k.^5.*(20+d.^2.*k.^2).*L1.^3.*L2.*pi.^(-1)+(sqrt(-1)*(-1/30240)).* ...
        d.^2.*k.^7.*(42+d.^2.*k.^2).*L1.^3.*L2.*pi.^(-1)+(sqrt(-1)*( ...
        1/1451520)).*d.^4.*k.^9.*(72+d.^2.*k.^2).*L1.^3.*L2.*pi.^(-1)+( ...
        sqrt(-1)*(-1/119750400)).*d.^6.*k.^11.*(110+d.^2.*k.^2).*L1.^3.* ...
        L2.*pi.^(-1)+(sqrt(-1)*(1/14944849920)).*d.^8.*k.^13.*(156+d.^2.* ...
        k.^2).*L1.^3.*L2.*pi.^(-1)+(sqrt(-1)*(-1/2615348736000)).*d.^10.* ...
        k.^15.*(210+d.^2.*k.^2).*L1.^3.*L2.*pi.^(-1)+(sqrt(-1)*(-1/100800) ...
        ).*k.^7.*(42+d.^2.*k.^2).*L1.^5.*L2.*pi.^(-1)+(sqrt(-1)*( ...
        1/2419200)).*d.^2.*k.^9.*(72+d.^2.*k.^2).*L1.^5.*L2.*pi.^(-1)+( ...
        sqrt(-1)*(-1/133056000)).*d.^4.*k.^11.*(110+d.^2.*k.^2).*L1.^5.* ...
        L2.*pi.^(-1)+(sqrt(-1)*(1/12454041600)).*d.^6.*k.^13.*(156+d.^2.* ...
        k.^2).*L1.^5.*L2.*pi.^(-1)+(sqrt(-1)*(-1/1743565824000)).*d.^8.* ...
        k.^15.*(210+d.^2.*k.^2).*L1.^5.*L2.*pi.^(-1)+(sqrt(-1)*( ...
        1/10160640)).*k.^9.*(72+d.^2.*k.^2).*L1.^7.*L2.*pi.^(-1)+(sqrt(-1) ...
        *(-1/279417600)).*d.^2.*k.^11.*(110+d.^2.*k.^2).*L1.^7.*L2.*pi.^( ...
        -1)+(sqrt(-1)*(1/17435658240)).*d.^4.*k.^13.*(156+d.^2.*k.^2).* ...
        L1.^7.*L2.*pi.^(-1)+(sqrt(-1)*(-1/1830744115200)).*d.^6.*k.^15.*( ...
        210+d.^2.*k.^2).*L1.^7.*L2.*pi.^(-1)+(sqrt(-1)*(-1/1437004800)).* ...
        k.^11.*(110+d.^2.*k.^2).*L1.^9.*L2.*pi.^(-1)+(sqrt(-1)*( ...
        1/44834549760)).*d.^2.*k.^13.*(156+d.^2.*k.^2).*L1.^9.*L2.*pi.^( ...
        -1)+(sqrt(-1)*(-1/3138418483200)).*d.^4.*k.^15.*(210+d.^2.*k.^2).* ...
        L1.^9.*L2.*pi.^(-1)+(sqrt(-1)*(1/273988915200)).*k.^13.*(156+ ...
        d.^2.*k.^2).*L1.^11.*L2.*pi.^(-1)+(sqrt(-1)*(-1/9589612032000)).* ...
        d.^2.*k.^15.*(210+d.^2.*k.^2).*L1.^11.*L2.*pi.^(-1)+(sqrt(-1)*( ...
        -1/67999067136000)).*k.^15.*(210+d.^2.*k.^2).*L1.^13.*L2.*pi.^(-1) ...
        +(sqrt(-1)*(-1/960)).*k.^5.*(20+d.^2.*k.^2).*L1.^2.*L2.^2.*pi.^( ...
        -1)+(sqrt(-1)*(1/20160)).*d.^2.*k.^7.*(42+d.^2.*k.^2).*L1.^2.* ...
        L2.^2.*pi.^(-1)+(sqrt(-1)*(1/40320)).*k.^7.*(42+d.^2.*k.^2).* ...
        L1.^4.*L2.^2.*pi.^(-1)+(sqrt(-1)*(-1/967680)).*d.^2.*k.^9.*(72+ ...
        d.^2.*k.^2).*L1.^4.*L2.^2.*pi.^(-1)+(sqrt(-1)*(1/53222400)).* ...
        d.^4.*k.^11.*(110+d.^2.*k.^2).*L1.^4.*L2.^2.*pi.^(-1)+(sqrt(-1)*( ...
        -1/4981616640)).*d.^6.*k.^13.*(156+d.^2.*k.^2).*L1.^4.*L2.^2.* ...
        pi.^(-1)+(sqrt(-1)*(1/697426329600)).*d.^8.*k.^15.*(210+d.^2.* ...
        k.^2).*L1.^4.*L2.^2.*pi.^(-1)+(sqrt(-1)*(-1/2903040)).*k.^9.*(72+ ...
        d.^2.*k.^2).*L1.^6.*L2.^2.*pi.^(-1)+(sqrt(-1)*(1/79833600)).* ...
        d.^2.*k.^11.*(110+d.^2.*k.^2).*L1.^6.*L2.^2.*pi.^(-1)+(sqrt(-1)*( ...
        -1/4981616640)).*d.^4.*k.^13.*(156+d.^2.*k.^2).*L1.^6.*L2.^2.* ...
        pi.^(-1)+(sqrt(-1)*(1/523069747200)).*d.^6.*k.^15.*(210+d.^2.* ...
        k.^2).*L1.^6.*L2.^2.*pi.^(-1)+(sqrt(-1)*(1/319334400)).*k.^11.*( ...
        110+d.^2.*k.^2).*L1.^8.*L2.^2.*pi.^(-1)+(sqrt(-1)*(-1/9963233280)) ...
        .*d.^2.*k.^13.*(156+d.^2.*k.^2).*L1.^8.*L2.^2.*pi.^(-1)+(sqrt(-1)* ...
        (1/697426329600)).*d.^4.*k.^15.*(210+d.^2.*k.^2).*L1.^8.*L2.^2.* ...
        pi.^(-1)+(sqrt(-1)*(-1/49816166400)).*k.^13.*(156+d.^2.*k.^2).* ...
        L1.^10.*L2.^2.*pi.^(-1)+(sqrt(-1)*(1/1743565824000)).*d.^2.* ...
        k.^15.*(210+d.^2.*k.^2).*L1.^10.*L2.^2.*pi.^(-1)+(sqrt(-1)*( ...
        1/10461394944000)).*k.^15.*(210+d.^2.*k.^2).*L1.^12.*L2.^2.*pi.^( ...
        -1)+(sqrt(-1)*(1/1440)).*k.^5.*(20+d.^2.*k.^2).*L1.*L2.^3.*pi.^( ...
        -1)+(sqrt(-1)*(-1/30240)).*d.^2.*k.^7.*(42+d.^2.*k.^2).*L1.* ...
        L2.^3.*pi.^(-1)+(sqrt(-1)*(1/1451520)).*d.^4.*k.^9.*(72+d.^2.* ...
        k.^2).*L1.*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/119750400)).*d.^6.* ...
        k.^11.*(110+d.^2.*k.^2).*L1.*L2.^3.*pi.^(-1)+(sqrt(-1)*( ...
        1/14944849920)).*d.^8.*k.^13.*(156+d.^2.*k.^2).*L1.*L2.^3.*pi.^( ...
        -1)+(sqrt(-1)*(-1/2615348736000)).*d.^10.*k.^15.*(210+d.^2.*k.^2) ...
        .*L1.*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/30240)).*k.^7.*(42+d.^2.*k.^2) ...
        .*L1.^3.*L2.^3.*pi.^(-1)+(sqrt(-1)*(1/725760)).*d.^2.*k.^9.*(72+ ...
        d.^2.*k.^2).*L1.^3.*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/39916800)).* ...
        d.^4.*k.^11.*(110+d.^2.*k.^2).*L1.^3.*L2.^3.*pi.^(-1)+(sqrt(-1)*( ...
        1/3736212480)).*d.^6.*k.^13.*(156+d.^2.*k.^2).*L1.^3.*L2.^3.*pi.^( ...
        -1)+(sqrt(-1)*(-1/523069747200)).*d.^8.*k.^15.*(210+d.^2.*k.^2).* ...
        L1.^3.*L2.^3.*pi.^(-1)+(sqrt(-1)*(1/1451520)).*k.^9.*(72+d.^2.* ...
        k.^2).*L1.^5.*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/39916800)).*d.^2.* ...
        k.^11.*(110+d.^2.*k.^2).*L1.^5.*L2.^3.*pi.^(-1)+(sqrt(-1)*( ...
        1/2490808320)).*d.^4.*k.^13.*(156+d.^2.*k.^2).*L1.^5.*L2.^3.*pi.^( ...
        -1)+(sqrt(-1)*(-1/261534873600)).*d.^6.*k.^15.*(210+d.^2.*k.^2).* ...
        L1.^5.*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/119750400)).*k.^11.*(110+ ...
        d.^2.*k.^2).*L1.^7.*L2.^3.*pi.^(-1)+(sqrt(-1)*(1/3736212480)).* ...
        d.^2.*k.^13.*(156+d.^2.*k.^2).*L1.^7.*L2.^3.*pi.^(-1)+(sqrt(-1)*( ...
        -1/261534873600)).*d.^4.*k.^15.*(210+d.^2.*k.^2).*L1.^7.*L2.^3.* ...
        pi.^(-1)+(sqrt(-1)*(1/14944849920)).*k.^13.*(156+d.^2.*k.^2).* ...
        L1.^9.*L2.^3.*pi.^(-1)+(sqrt(-1)*(-1/523069747200)).*d.^2.*k.^15.* ...
        (210+d.^2.*k.^2).*L1.^9.*L2.^3.*pi.^(-1)+(sqrt(-1)*( ...
        -1/2615348736000)).*k.^15.*(210+d.^2.*k.^2).*L1.^11.*L2.^3.*pi.^( ...
        -1)+(sqrt(-1)*(1/40320)).*k.^7.*(42+d.^2.*k.^2).*L1.^2.*L2.^4.* ...
        pi.^(-1)+(sqrt(-1)*(-1/1161216)).*k.^9.*(72+d.^2.*k.^2).*L1.^4.* ...
        L2.^4.*pi.^(-1)+(sqrt(-1)*(1/31933440)).*d.^2.*k.^11.*(110+d.^2.* ...
        k.^2).*L1.^4.*L2.^4.*pi.^(-1)+(sqrt(-1)*(-1/1992646656)).*d.^4.* ...
        k.^13.*(156+d.^2.*k.^2).*L1.^4.*L2.^4.*pi.^(-1)+(sqrt(-1)*( ...
        1/209227898880)).*d.^6.*k.^15.*(210+d.^2.*k.^2).*L1.^4.*L2.^4.* ...
        pi.^(-1)+(sqrt(-1)*(1/68428800)).*k.^11.*(110+d.^2.*k.^2).*L1.^6.* ...
        L2.^4.*pi.^(-1)+(sqrt(-1)*(-1/2134978560)).*d.^2.*k.^13.*(156+ ...
        d.^2.*k.^2).*L1.^6.*L2.^4.*pi.^(-1)+(sqrt(-1)*(1/149448499200)).* ...
        d.^4.*k.^15.*(210+d.^2.*k.^2).*L1.^6.*L2.^4.*pi.^(-1)+(sqrt(-1)*( ...
        -1/6642155520)).*k.^13.*(156+d.^2.*k.^2).*L1.^8.*L2.^4.*pi.^(-1)+( ...
        sqrt(-1)*(1/232475443200)).*d.^2.*k.^15.*(210+d.^2.*k.^2).*L1.^8.* ...
        L2.^4.*pi.^(-1)+(sqrt(-1)*(1/951035904000)).*k.^15.*(210+d.^2.* ...
        k.^2).*L1.^10.*L2.^4.*pi.^(-1)+(sqrt(-1)*(-1/100800)).*k.^7.*(42+ ...
        d.^2.*k.^2).*L1.*L2.^5.*pi.^(-1)+(sqrt(-1)*(1/2419200)).*d.^2.* ...
        k.^9.*(72+d.^2.*k.^2).*L1.*L2.^5.*pi.^(-1)+(sqrt(-1)*( ...
        -1/133056000)).*d.^4.*k.^11.*(110+d.^2.*k.^2).*L1.*L2.^5.*pi.^(-1) ...
        +(sqrt(-1)*(1/12454041600)).*d.^6.*k.^13.*(156+d.^2.*k.^2).*L1.* ...
        L2.^5.*pi.^(-1)+(sqrt(-1)*(-1/1743565824000)).*d.^8.*k.^15.*(210+ ...
        d.^2.*k.^2).*L1.*L2.^5.*pi.^(-1)+(sqrt(-1)*(1/1451520)).*k.^9.*( ...
        72+d.^2.*k.^2).*L1.^3.*L2.^5.*pi.^(-1)+(sqrt(-1)*(-1/39916800)).* ...
        d.^2.*k.^11.*(110+d.^2.*k.^2).*L1.^3.*L2.^5.*pi.^(-1)+(sqrt(-1)*( ...
        1/2490808320)).*d.^4.*k.^13.*(156+d.^2.*k.^2).*L1.^3.*L2.^5.*pi.^( ...
        -1)+(sqrt(-1)*(-1/261534873600)).*d.^6.*k.^15.*(210+d.^2.*k.^2).* ...
        L1.^3.*L2.^5.*pi.^(-1)+(sqrt(-1)*(-1/57024000)).*k.^11.*(110+ ...
        d.^2.*k.^2).*L1.^5.*L2.^5.*pi.^(-1)+(sqrt(-1)*(1/1779148800)).* ...
        d.^2.*k.^13.*(156+d.^2.*k.^2).*L1.^5.*L2.^5.*pi.^(-1)+(sqrt(-1)*( ...
        -1/124540416000)).*d.^4.*k.^15.*(210+d.^2.*k.^2).*L1.^5.*L2.^5.* ...
        pi.^(-1)+(sqrt(-1)*(1/4151347200)).*k.^13.*(156+d.^2.*k.^2).* ...
        L1.^7.*L2.^5.*pi.^(-1)+(sqrt(-1)*(-1/145297152000)).*d.^2.*k.^15.* ...
        (210+d.^2.*k.^2).*L1.^7.*L2.^5.*pi.^(-1)+(sqrt(-1)*( ...
        -1/475517952000)).*k.^15.*(210+d.^2.*k.^2).*L1.^9.*L2.^5.*pi.^(-1) ...
        +(sqrt(-1)*(1/68428800)).*k.^11.*(110+d.^2.*k.^2).*L1.^4.*L2.^6.* ...
        pi.^(-1)+(sqrt(-1)*(-1/2134978560)).*d.^2.*k.^13.*(156+d.^2.*k.^2) ...
        .*L1.^4.*L2.^6.*pi.^(-1)+(sqrt(-1)*(1/149448499200)).*d.^4.* ...
        k.^15.*(210+d.^2.*k.^2).*L1.^4.*L2.^6.*pi.^(-1)+(sqrt(-1)*( ...
        -1/3558297600)).*k.^13.*(156+d.^2.*k.^2).*L1.^6.*L2.^6.*pi.^(-1)+( ...
        sqrt(-1)*(1/124540416000)).*d.^2.*k.^15.*(210+d.^2.*k.^2).*L1.^6.* ...
        L2.^6.*pi.^(-1)+(sqrt(-1)*(1/317011968000)).*k.^15.*(210+d.^2.* ...
        k.^2).*L1.^8.*L2.^6.*pi.^(-1)+(sqrt(-1)*(1/10160640)).*k.^9.*(72+ ...
        d.^2.*k.^2).*L1.*L2.^7.*pi.^(-1)+(sqrt(-1)*(-1/279417600)).*d.^2.* ...
        k.^11.*(110+d.^2.*k.^2).*L1.*L2.^7.*pi.^(-1)+(sqrt(-1)*( ...
        1/17435658240)).*d.^4.*k.^13.*(156+d.^2.*k.^2).*L1.*L2.^7.*pi.^( ...
        -1)+(sqrt(-1)*(-1/1830744115200)).*d.^6.*k.^15.*(210+d.^2.*k.^2).* ...
        L1.*L2.^7.*pi.^(-1)+(sqrt(-1)*(-1/119750400)).*k.^11.*(110+d.^2.* ...
        k.^2).*L1.^3.*L2.^7.*pi.^(-1)+(sqrt(-1)*(1/3736212480)).*d.^2.* ...
        k.^13.*(156+d.^2.*k.^2).*L1.^3.*L2.^7.*pi.^(-1)+(sqrt(-1)*( ...
        -1/261534873600)).*d.^4.*k.^15.*(210+d.^2.*k.^2).*L1.^3.*L2.^7.* ...
        pi.^(-1)+(sqrt(-1)*(1/4151347200)).*k.^13.*(156+d.^2.*k.^2).* ...
        L1.^5.*L2.^7.*pi.^(-1)+(sqrt(-1)*(-1/145297152000)).*d.^2.*k.^15.* ...
        (210+d.^2.*k.^2).*L1.^5.*L2.^7.*pi.^(-1)+(sqrt(-1)*( ...
        -1/277385472000)).*k.^15.*(210+d.^2.*k.^2).*L1.^7.*L2.^7.*pi.^(-1) ...
        +(sqrt(-1)*(-1/6642155520)).*k.^13.*(156+d.^2.*k.^2).*L1.^4.* ...
        L2.^8.*pi.^(-1)+(sqrt(-1)*(1/232475443200)).*d.^2.*k.^15.*(210+ ...
        d.^2.*k.^2).*L1.^4.*L2.^8.*pi.^(-1)+(sqrt(-1)*(1/317011968000)).* ...
        k.^15.*(210+d.^2.*k.^2).*L1.^6.*L2.^8.*pi.^(-1)+(sqrt(-1)*( ...
        -1/1437004800)).*k.^11.*(110+d.^2.*k.^2).*L1.*L2.^9.*pi.^(-1)+( ...
        sqrt(-1)*(1/44834549760)).*d.^2.*k.^13.*(156+d.^2.*k.^2).*L1.* ...
        L2.^9.*pi.^(-1)+(sqrt(-1)*(-1/3138418483200)).*d.^4.*k.^15.*(210+ ...
        d.^2.*k.^2).*L1.*L2.^9.*pi.^(-1)+(sqrt(-1)*(1/14944849920)).* ...
        k.^13.*(156+d.^2.*k.^2).*L1.^3.*L2.^9.*pi.^(-1)+(sqrt(-1)*( ...
        -1/523069747200)).*d.^2.*k.^15.*(210+d.^2.*k.^2).*L1.^3.*L2.^9.* ...
        pi.^(-1)+(sqrt(-1)*(-1/475517952000)).*k.^15.*(210+d.^2.*k.^2).* ...
        L1.^5.*L2.^9.*pi.^(-1)+(sqrt(-1)*(1/951035904000)).*k.^15.*(210+ ...
        d.^2.*k.^2).*L1.^4.*L2.^10.*pi.^(-1)+(sqrt(-1)*(1/273988915200)).* ...
        k.^13.*(156+d.^2.*k.^2).*L1.*L2.^11.*pi.^(-1)+(sqrt(-1)*( ...
        -1/9589612032000)).*d.^2.*k.^15.*(210+d.^2.*k.^2).*L1.*L2.^11.* ...
        pi.^(-1)+(sqrt(-1)*(-1/2615348736000)).*k.^15.*(210+d.^2.*k.^2).* ...
        L1.^3.*L2.^11.*pi.^(-1)+(sqrt(-1)*(-1/67999067136000)).*k.^15.*( ...
        210+d.^2.*k.^2).*L1.*L2.^13.*pi.^(-1)+(-1/4).*k.^2.*(d.^2+L2.^2) ...
        .^(1/2).*pi.^(-1)+(-1/8).*k.^2.*(2+d.^2.*k.^2).*(d.^2+L2.^2).^( ...
        1/2).*pi.^(-1)+(1/192).*d.^2.*k.^4.*(12+d.^2.*k.^2).*(d.^2+L2.^2) ...
        .^(1/2).*pi.^(-1)+(-1/7680).*d.^4.*k.^6.*(30+d.^2.*k.^2).*(d.^2+ ...
        L2.^2).^(1/2).*pi.^(-1)+(1/516096).*d.^6.*k.^8.*(56+d.^2.*k.^2).*( ...
        d.^2+L2.^2).^(1/2).*pi.^(-1)+(-1/53084160).*d.^8.*k.^10.*(90+ ...
        d.^2.*k.^2).*(d.^2+L2.^2).^(1/2).*pi.^(-1)+(1/7785676800).*d.^10.* ...
        k.^12.*(132+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2).*pi.^(-1)+( ...
        -1/1545810739200).*d.^12.*k.^14.*(182+d.^2.*k.^2).*(d.^2+L2.^2).^( ...
        1/2).*pi.^(-1)+(-1/576).*k.^4.*(12+d.^2.*k.^2).*(d.^2+L2.^2).^( ...
        3/2).*pi.^(-1)+(1/23040).*d.^2.*k.^6.*(30+d.^2.*k.^2).*(d.^2+ ...
        L2.^2).^(3/2).*pi.^(-1)+(1/57600).*k.^6.*(30+d.^2.*k.^2).*(d.^2+ ...
        L2.^2).^(5/2).*pi.^(-1)+(sqrt(-1)*(-1/2903040)).*k.^9.*(72+d.^2.* ...
        k.^2).*L1.^2.*(d.^2+L2.^2).^3.*pi.^(-1)+(sqrt(-1)*(1/319334400)).* ...
        k.^11.*(110+d.^2.*k.^2).*L1.^2.*(d.^2+L2.^2).^4.*pi.^(-1)+(sqrt( ...
        -1)*(-1/49816166400)).*k.^13.*(156+d.^2.*k.^2).*L1.^2.*(d.^2+ ...
        L2.^2).^5.*pi.^(-1)+(sqrt(-1)*(1/10461394944000)).*k.^15.*(210+ ...
        d.^2.*k.^2).*L1.^2.*(d.^2+L2.^2).^6.*pi.^(-1)+(-1/23040).*d.^2.* ...
        k.^6.*(30+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).^2.*(d.^2+L1.^2+( ...
        -2).*L1.*L2+L2.^2).^(-1/2).*pi.^(-1)+(-1/57600).*k.^6.*(30+d.^2.* ...
        k.^2).*(d.^2+(L1+(-1).*L2).^2).^3.*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2) ...
        .^(-1/2).*pi.^(-1)+(1/15482880).*k.^8.*(56+d.^2.*k.^2).*(d.^2+(L1+ ...
        (-1).*L2).^2).*((114/7).*d.^6+(174/7).*d.^4.*(L1+(-1).*L2).^2+( ...
        76/7).*d.^2.*(L1+(-1).*L2).^4+(16/7).*(L1+(-1).*L2).^6).*(d.^2+ ...
        L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2).*pi.^(-1)+(-1/11147673600).* ...
        k.^10.*(90+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).*((374/3).*d.^8+( ...
        650/3).*d.^6.*(L1+(-1).*L2).^2+140.*d.^4.*(L1+(-1).*L2).^4+(176/3) ...
        .*d.^2.*(L1+(-1).*L2).^6+(32/3).*(L1+(-1).*L2).^8).*(d.^2+L1.^2+( ...
        -2).*L1.*L2+L2.^2).^(-1/2).*pi.^(-1)+(1/2452488192000).*k.^12.*( ...
        132+d.^2.*k.^2).*(d.^2+(L1+(-1).*L2).^2).*((2185/11).*d.^10+( ...
        4215/11).*d.^8.*(L1+(-1).*L2).^2+(3590/11).*d.^6.*(L1+(-1).*L2) ...
        .^4+(2248/11).*d.^4.*(L1+(-1).*L2).^6+(816/11).*d.^2.*(L1+(-1).* ...
        L2).^8+(128/11).*(L1+(-1).*L2).^10).*(d.^2+L1.^2+(-2).*L1.*L2+ ...
        L2.^2).^(-1/2).*pi.^(-1)+(-1/5356234211328000).*k.^14.*(182+d.^2.* ...
        k.^2).*(d.^2+(L1+(-1).*L2).^2).*((29685/13).*d.^12+(62475/13).* ...
        d.^10.*(L1+(-1).*L2).^2+(65870/13).*d.^8.*(L1+(-1).*L2).^4+( ...
        54824/13).*d.^6.*(L1+(-1).*L2).^6+(29808/13).*d.^4.*(L1+(-1).*L2) ...
        .^8+(9344/13).*d.^2.*(L1+(-1).*L2).^10+(1280/13).*(L1+(-1).*L2) ...
        .^12).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).^(-1/2).*pi.^(-1)+(1/4).* ...
        k.^2.*(d.^2+(L1+(-1).*L2).^2).^(-1/2).*(d.^2+L1.^2+(-2).*L1.*L2+ ...
        L2.^2).*pi.^(-1)+(1/576).*k.^4.*(12+d.^2.*k.^2).*(d.^2+(L1+(-1).* ...
        L2).^2).^(1/2).*(d.^2+L1.^2+(-2).*L1.*L2+L2.^2).*pi.^(-1)+( ...
        -1/15482880).*k.^8.*(56+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2).*((114/7) ...
        .*d.^6+(174/7).*d.^4.*L2.^2+(76/7).*d.^2.*L2.^4+(16/7).*L2.^6).* ...
        pi.^(-1)+(1/11147673600).*k.^10.*(90+d.^2.*k.^2).*(d.^2+L2.^2).^( ...
        1/2).*((374/3).*d.^8+(650/3).*d.^6.*L2.^2+140.*d.^4.*L2.^4+(176/3) ...
        .*d.^2.*L2.^6+(32/3).*L2.^8).*pi.^(-1)+(-1/2452488192000).*k.^12.* ...
        (132+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2).*((2185/11).*d.^10+(4215/11) ...
        .*d.^8.*L2.^2+(3590/11).*d.^6.*L2.^4+(2248/11).*d.^4.*L2.^6+( ...
        816/11).*d.^2.*L2.^8+(128/11).*L2.^10).*pi.^(-1)+( ...
        1/5356234211328000).*k.^14.*(182+d.^2.*k.^2).*(d.^2+L2.^2).^(1/2) ...
        .*((29685/13).*d.^12+(62475/13).*d.^10.*L2.^2+(65870/13).*d.^8.* ...
        L2.^4+(54824/13).*d.^6.*L2.^6+(29808/13).*d.^4.*L2.^8+(9344/13).* ...
        d.^2.*L2.^10+(1280/13).*L2.^12).*pi.^(-1)+(sqrt(-1)*(1/4)).*d.* ...
        k.^3.*L2.*pi.^(-1).*atan(d.^(-1).*(L1+(-1).*L2))+(sqrt(-1)*(1/4)) ...
        .*d.*k.^3.*L2.*pi.^(-1).*atan(d.^(-1).*L2)+(sqrt(-1)*(1/8)).* ...
        d.^2.*k.^3.*pi.^(-1).*log(d.^2)+(sqrt(-1)*(-1/4)).*d.^2.*k.^3.* ...
        pi.^(-1).*((-1).*d.^(-1).*L1.*atan(d.^(-1).*L1)+(1/2).*log(d.^2+ ...
        L1.^2))+(1/8).*k.^2.*(2+d.^2.*k.^2).*L1.*pi.^(-1).*log(L1+(d.^2+ ...
        L1.^2).^(1/2))+(-1/192).*d.^2.*k.^4.*(12+d.^2.*k.^2).*L1.*pi.^(-1) ...
        .*log(L1+(d.^2+L1.^2).^(1/2))+(1/7680).*d.^4.*k.^6.*(30+d.^2.* ...
        k.^2).*L1.*pi.^(-1).*log(L1+(d.^2+L1.^2).^(1/2))+(-1/516096).* ...
        d.^6.*k.^8.*(56+d.^2.*k.^2).*L1.*pi.^(-1).*log(L1+(d.^2+L1.^2).^( ...
        1/2))+(1/53084160).*d.^8.*k.^10.*(90+d.^2.*k.^2).*L1.*pi.^(-1).* ...
        log(L1+(d.^2+L1.^2).^(1/2))+(-1/7785676800).*d.^10.*k.^12.*(132+ ...
        d.^2.*k.^2).*L1.*pi.^(-1).*log(L1+(d.^2+L1.^2).^(1/2))+( ...
        1/1545810739200).*d.^12.*k.^14.*(182+d.^2.*k.^2).*L1.*pi.^(-1).* ...
        log(L1+(d.^2+L1.^2).^(1/2))+(sqrt(-1)*(1/4)).*d.^2.*k.^3.*pi.^(-1) ...
        .*((-1).*d.^(-1).*L1.*atan(d.^(-1).*(L1+(-1).*L2))+(1/2).*log( ...
        d.^2+(L1+(-1).*L2).^2))+(-1/8).*k.^2.*(2+d.^2.*k.^2).*(L1+(-1).* ...
        L2).*pi.^(-1).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+( ...
        1/192).*d.^2.*k.^4.*(12+d.^2.*k.^2).*(L1+(-1).*L2).*pi.^(-1).*log( ...
        L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+(-1/7680).*d.^4.* ...
        k.^6.*(30+d.^2.*k.^2).*(L1+(-1).*L2).*pi.^(-1).*log(L1+(d.^2+(L1+( ...
        -1).*L2).^2).^(1/2)+(-1).*L2)+(1/516096).*d.^6.*k.^8.*(56+d.^2.* ...
        k.^2).*(L1+(-1).*L2).*pi.^(-1).*log(L1+(d.^2+(L1+(-1).*L2).^2).^( ...
        1/2)+(-1).*L2)+(-1/53084160).*d.^8.*k.^10.*(90+d.^2.*k.^2).*(L1+( ...
        -1).*L2).*pi.^(-1).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).* ...
        L2)+(1/7785676800).*d.^10.*k.^12.*(132+d.^2.*k.^2).*(L1+(-1).*L2) ...
        .*pi.^(-1).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+( ...
        -1/1545810739200).*d.^12.*k.^14.*(182+d.^2.*k.^2).*(L1+(-1).*L2).* ...
        pi.^(-1).*log(L1+(d.^2+(L1+(-1).*L2).^2).^(1/2)+(-1).*L2)+(sqrt( ...
        -1)*(-1/8)).*d.^2.*k.^3.*pi.^(-1).*log(d.^2+L2.^2)+(-1/8).*k.^2.*( ...
        2+d.^2.*k.^2).*L2.*pi.^(-1).*log((-1).*L2+(d.^2+L2.^2).^(1/2))+( ...
        1/192).*d.^2.*k.^4.*(12+d.^2.*k.^2).*L2.*pi.^(-1).*log((-1).*L2+( ...
        d.^2+L2.^2).^(1/2))+(-1/7680).*d.^4.*k.^6.*(30+d.^2.*k.^2).*L2.* ...
        pi.^(-1).*log((-1).*L2+(d.^2+L2.^2).^(1/2))+(1/516096).*d.^6.* ...
        k.^8.*(56+d.^2.*k.^2).*L2.*pi.^(-1).*log((-1).*L2+(d.^2+L2.^2).^( ...
        1/2))+(-1/53084160).*d.^8.*k.^10.*(90+d.^2.*k.^2).*L2.*pi.^(-1).* ...
        log((-1).*L2+(d.^2+L2.^2).^(1/2))+(1/7785676800).*d.^10.*k.^12.*( ...
        132+d.^2.*k.^2).*L2.*pi.^(-1).*log((-1).*L2+(d.^2+L2.^2).^(1/2))+( ...
        -1/1545810739200).*d.^12.*k.^14.*(182+d.^2.*k.^2).*L2.*pi.^(-1).* ...
        log((-1).*L2+(d.^2+L2.^2).^(1/2));
    H3_total = H3_12O;
else
    error('Calculation of that order not caulculated')
end
end

